 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 1 - 11/14/2020 15:50:57


       1/       0 :                     ; *****************************************************************************************
       2/       0 :                     ; Copyright (c) 2020 by Richard Dienstknecht
       3/       0 :                     ; Changes:
       4/       0 :                     ; Gaston Williams, July, 2020 - Modified file to use Initialize.asm and tty1861.asm
       5/       0 :                     ; *****************************************************************************************
       6/       0 :                     
       7/       0 : ="TRUE"             UseGraphics                     EQU "TRUE"
       8/       0 : ="64x64"            Resolution                      EQU "64x64"            ; "64x32", "64x64" or "64x128"
       9/       0 : ="OFF"              BackBuffer                      EQU "OFF"               ; 'OFF', 'COPY' or 'SWAP'
      10/       0 :                     
      11/       0 : ="TRUE"             UseText                         EQU "TRUE"
      12/       0 : ="TRUE"             UseTty                          EQU "TRUE"
      13/       0 :                     
      14/       0 :                                                     INCLUDE "StdDefs.asm"
(1)    1/       0 :                     ; *****************************************************************************************
(1)    2/       0 :                     ; Copyright (c) 2020 
(1)    3/       0 :                     ; by Richard Dienstknecht
(1)    4/       0 :                     ;
(1)    5/       0 :                     ; Changes:
(1)    6/       0 :                     ; Gaston Williams, July, 2020   - Added Macros for Std Call and Std Return
(1)    7/       0 :                     ; Gaston Williams  August, 2020 - Added Macro for loading Register
(1)    8/       0 :                     ; *****************************************************************************************
(1)    9/       0 :                     
(1)   10/       0 :                     ; =========================================================================================
(1)   11/       0 :                     ; Register definitions
(1)   12/       0 :                     ; =========================================================================================
(1)   13/       0 :                     
(1)   14/       0 : =0H                 R0                                      EQU 00H
(1)   15/       0 : =1H                 R1                                      EQU 01H
(1)   16/       0 : =2H                 R2                                      EQU 02H
(1)   17/       0 : =3H                 R3                                      EQU 03H
(1)   18/       0 : =4H                 R4                                      EQU 04H
(1)   19/       0 : =5H                 R5                                      EQU 05H
(1)   20/       0 : =6H                 R6                                      EQU 06H
(1)   21/       0 : =7H                 R7                                      EQU 07H
(1)   22/       0 : =8H                 R8                                      EQU 08H
(1)   23/       0 : =9H                 R9                                      EQU 09H
(1)   24/       0 : =0AH                RA                                      EQU 0AH
(1)   25/       0 : =0BH                RB                                      EQU 0BH
(1)   26/       0 : =0CH                RC                                      EQU 0CH
(1)   27/       0 : =0DH                RD                                      EQU 0DH
(1)   28/       0 : =0EH                RE                                      EQU 0EH
(1)   29/       0 : =0FH                RF                                      EQU 0FH
(1)   30/       0 :                     
(1)   31/       0 :                     ;------------------------------------------------------------------------------------------
(1)   32/       0 :                     ; =========================================================================================
(1)   33/       0 :                     ; Macro definitions for standard call and return
(1)   34/       0 :                     ; See RCA CDP1802 User Manual, page 61 for more information
(1)   35/       0 :                     ; =========================================================================================
(1)   36/       0 :                     
(1)   37/       0 :                     CALL    MACRO   param1
(1)   38/       0 :                             SEP R4
(1)   39/       0 :                             dw  param1
(1)   40/       0 :                             ENDM
(1)   41/       0 :                             
(1)   42/       0 :                     RETURN  MACRO
(1)   43/       0 :                             SEP R5
(1)   44/       0 :                             ENDM
(1)   45/       0 :                             
(1)   46/       0 :                     LOAD    MACRO   param1, param2
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(StdDefs.asm) - Page 2 - 11/14/2020 15:50:57


(1)   47/       0 :                             LDI  lo(param2)
(1)   48/       0 :                             PLO  param1
(1)   49/       0 :                             LDI  hi(param2)
(1)   50/       0 :                             PHI  param1     
(1)   51/       0 :                             ENDM
      15/       0 :                                                     INCLUDE "Initialize.asm"
(1)    1/       0 :                     ; *****************************************************************************************
(1)    2/       0 :                     ; Copyright (c) 2020
(1)    3/       0 :                     ; by Richard Dienstknecht
(1)    4/       0 :                     ;
(1)    5/       0 :                     ; Changes:
(1)    6/       0 :                     ; Gaston Williams, July, 2020 - Rewrote Initialisation.asm file as Initialize.asm
(1)    7/       0 :                     ; Gaston Williams, July, 2020 - Removed unused include files
(1)    8/       0 :                     ; Gaston Williams, July, 2020 - Replaced Std Call and Return with Macros
(1)    9/       0 :                     ; Gaston Williams  Aug,  2020 - Added IF blocks to change compile order
(1)   10/       0 :                     ; Gaston Williams  Aug,  2020 - Included padding file
(1)   11/       0 :                     ; Gaston Williams  Aug,  2020 - Added Macro for loading Register
(1)   12/       0 :                     ; Gaston Williams  Aug,  2020 - Restored 64x128 resolution
(1)   13/       0 :                     ; *****************************************************************************************
(1)   14/       0 :                                                     INCLUDE "bitfuncs.inc"
(2)    1/       0 : =>UNDEFINED         		ifndef   bitfuncsinc    ; avoid multiple inclusion
(2)    2/       0 : =1H                 bitfuncsinc     equ      1
(2)    3/       0 :                     
(2)    4/       0 :                                     save
(2)   77/       0 : ALL                                 restore                 ; allow listing again
(2)   78/       0 :                     
(2)   79/       0 : [1]                                 endif			; bitfuncsinc
(2)   80/       0 :                     
(2)   81/       0 :                     
(1)   15/       0 :                                                     INCLUDE "buffers.asm"
(2)    1/       0 :                     ; *****************************************************************************************
(2)    2/       0 :                     ; Copyright (c) 2020 
(2)    3/       0 :                     ; by Richard Dienstknecht
(2)    4/       0 :                     ;
(2)    5/       0 :                     ; Changes:
(2)    6/       0 :                     ; Gaston Williams, July, 2020 - Removed 64x128 Resolution logic
(2)    7/       0 :                     ; Gaston Williams, July, 2020 - Put Buffer definitions into a separate file
(2)    8/       0 :                     ; Gaston Williams, Aug,  2020 - Added Cursor and Video flag definitions
(2)    9/       0 :                     ; Gaston Williams, Sept, 2020 - Restored 64x128 Resolution logic
(2)   10/       0 :                     ; *****************************************************************************************
(2)   11/       0 :                     
(2)   12/       0 :                     ; =========================================================================================
(2)   13/       0 :                     ; Define Video Buffers and Main Stack
(2)   14/       0 :                     ; =========================================================================================
(2)   15/       0 :                                                             CPU 1802
(2)   16/       0 :                                                             
(2)   17/       0 :                     ; =========================================================================================
(2)   18/       0 :                     ; Display buffers
(2)   19/       0 :                     ; =========================================================================================
(2)   20/       0 : =>TRUE                              IF BackBuffer == "OFF"                  ; OFF uses only one video buffer
(2)   21/       0 : =>FALSE                                     IF Resolution == "64x32"
(2)   22/       0 :                                                     ORG 7E00H       
(2)   23/       0 :                     DisplayBuffer:                  db 256 dup (?)
(2)   24/       0 : [21]                                        ENDIF
(2)   25/       0 :                     
(2)   26/       0 : =>TRUE                                      IF Resolution == "64x64"
(2)   27/    7D00 :                                                     ORG 7D00H
(2)   28/    7D00 :                     DisplayBuffer:                  db 512 dup (?)
(2)   29/    7F00 : [26]                                        ENDIF
(2)   30/    7F00 :                     
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(buffers.asm) - Page 3 - 11/14/2020 15:50:57


(2)   31/    7F00 : =>FALSE                                     IF Resolution == "64x128"
(2)   32/    7F00 :                                                     ORG 7B00H
(2)   33/    7F00 :                     DisplayBuffer:                  db 1024 dup (?)
(2)   34/    7F00 : [31]                                        ENDIF
(2)   35/    7F00 :                                             
(2)   36/    7F00 :                                     
(2)   37/    7F00 : [20]                                ENDIF
(2)   38/    7F00 :                                     
(2)   39/    7F00 : =>FALSE                             IF BackBuffer <> "OFF"                  ; COPY and SWAP use two video buffers
(2)   40/    7F00 :                                             IF Resolution == "64x32"
(2)   41/    7F00 :                                                     ORG 7D00H       
(2)   42/    7F00 :                     DisplayBuffer:                  db 256 dup (?)
(2)   43/    7F00 :                     DoubleBuffer:                   db 256 dup (?)
(2)   44/    7F00 : [40]                                        ENDIF
(2)   45/    7F00 :                     
(2)   46/    7F00 :                                             IF Resolution == "64x64"
(2)   47/    7F00 :                                                     ORG 7B00H
(2)   48/    7F00 :                     DisplayBuffer:                  db 512 dup (?)
(2)   49/    7F00 :                     DoubleBuffer:                   db 512 dup (?)
(2)   50/    7F00 : [46]                                        ENDIF
(2)   51/    7F00 :                                             
(2)   52/    7F00 :                                             IF Resolution == "64x128"
(2)   53/    7F00 :                                                     ORG 7700H
(2)   54/    7F00 :                     DisplayBuffer:                  db 1024 dup (?)
(2)   55/    7F00 :                     DoubleBuffer:                   db 1024 dup (?)
(2)   56/    7F00 : [52]                                        ENDIF                                   
(2)   57/    7F00 : [39]                                ENDIF
(2)   58/    7F00 :                     
(2)   59/    7F00 :                                                     ORG 7F00H
(2)   60/    7F00 :                                                     
(2)   61/    7F00 :                     ; =========================================================================================
(2)   62/    7F00 :                     ; Buffer for unpacked characters
(2)   63/    7F00 :                     ; =========================================================================================
(2)   64/    7F00 :                     
(2)   65/    7F00 :                     CharacterPattern:       db 5 dup ?
(2)   66/    7F05 :                     
(2)   67/    7F05 :                     ; =========================================================================================
(2)   68/    7F05 :                     ; Cursor location for video console
(2)   69/    7F05 :                     ; =========================================================================================
(2)   70/    7F05 :                     
(2)   71/    7F05 :                     CursorX                 db ?
(2)   72/    7F06 :                     
(2)   73/    7F06 :                     CursorY                 db ?
(2)   74/    7F07 :                     ;------------------------------------------------------------------------------------------
(2)   75/    7F07 :                     
(2)   76/    7F07 :                     ; =========================================================================================
(2)   77/    7F07 :                     ; Flag to indicate if 1861 Video is currently on or off
(2)   78/    7F07 :                     ; =========================================================================================
(2)   79/    7F07 :                     
(2)   80/    7F07 :                     VideoFlag               db ?
(2)   81/    7F08 :                     ;------------------------------------------------------------------------------------------
(2)   82/    7F08 :                     
(2)   83/    7F08 :                     ; 
(2)   84/    7F08 :                     ;Buffers and variables end at 7F08, leaving 120 bytes available for program stack
(2)   85/    7F08 :                     
(2)   86/    7F08 :                     
(2)   87/    7F08 :                     ; =========================================================================================
(2)   88/    7F08 :                     ; Space for the main stack
(2)   89/    7F08 :                     ; =========================================================================================
(2)   90/    7F08 :                     
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(buffers.asm) - Page 4 - 11/14/2020 15:50:57


(2)   91/    7F08 :                                                             
(2)   92/    7F7F :                                             ORG 7F7FH
(2)   93/    7F7F :                     StackTop:
(2)   94/    7F7F :                     ;------------------------------------------------------------------------------------------     
(2)   95/    7F7F :                     
(2)   96/    7F7F :                     ; =========================================================================================
(2)   97/    7F7F :                     ; Reserve 7F80H to 7FFFH for Super Monitor program
(2)   98/    7F7F :                     ; =========================================================================================
(1)   16/    7F7F :                     
(1)   17/    7F7F :                     ; =========================================================================================
(1)   18/    7F7F :                     ; Starting point of the program and initialisation of the CPU registers
(1)   19/    7F7F :                     ;
(1)   20/    7F7F :                     ; R0            Reserved as pointer to the DMA buffer
(1)   21/    7F7F :                     ; R1            Reserved as interrupt vector
(1)   22/    7F7F :                     ; R2            Main stack pointer
(1)   23/    7F7F :                     ; R3            Main program counter
(1)   24/    7F7F :                     ; R4            Program counter for standard call procedure
(1)   25/    7F7F :                     ; R5            Program counter for standard return procedure
(1)   26/    7F7F :                     ; R6            Reserved for temporary values from standard call/return procedures
(1)   27/    7F7F :                     ; R7 - RF       Free to use in the program, not initialized
(1)   28/    7F7F :                     ; =========================================================================================
(1)   29/    7F7F :                                                     CPU 1802
(1)   30/       0 :                                                     ORG 0000H
(1)   31/       0 :                     
(1)   32/       0 : (MACRO)             Init:                           LOAD R1, DisplayInt     ; DMA Buffer pointer
(1)   32/       0 : F8 44                       LDI  lo(DISPLAYINT)
(1)   32/       2 : A1                          PLO  R1
(1)   32/       3 : F8 00                       LDI  hi(DISPLAYINT)
(1)   32/       5 : B1                          PHI  R1     
(1)   33/       6 :                     
(1)   34/       6 : (MACRO)                                             LOAD R2, StackTop       ; Main Stack pointer
(1)   34/       6 : F8 7F                       LDI  lo(STACKTOP)
(1)   34/       8 : A2                          PLO  R2
(1)   34/       9 : F8 7F                       LDI  hi(STACKTOP)
(1)   34/       B : B2                          PHI  R2     
(1)   35/       C :                     
(1)   36/       C : (MACRO)                                             LOAD R3, Start          ; Main Program Counter
(1)   36/       C : F8 DC                       LDI  lo(START)
(1)   36/       E : A3                          PLO  R3
(1)   36/       F : F8 04                       LDI  hi(START)
(1)   36/      11 : B3                          PHI  R3     
(1)   37/      12 :                     
(1)   38/      12 : (MACRO)                                             LOAD R4, StdCall        ; Standard CALL procedure
(1)   38/      12 : F8 20                       LDI  lo(STDCALL)
(1)   38/      14 : A4                          PLO  R4
(1)   38/      15 : F8 00                       LDI  hi(STDCALL)
(1)   38/      17 : B4                          PHI  R4     
(1)   39/      18 :                     
(1)   40/      18 : (MACRO)                                             LOAD R5, StdReturn      ; Standard RETURN procedure
(1)   40/      18 : F8 30                       LDI  lo(STDRETURN)
(1)   40/      1A : A5                          PLO  R5
(1)   40/      1B : F8 00                       LDI  hi(STDRETURN)
(1)   40/      1D : B5                          PHI  R5     
(1)   41/      1E :                     
(1)   42/      1E : D3                                                  SEP  R3                 ; Run Main program
(1)   43/      1F :                     ;------------------------------------------------------------------------------------------
(1)   44/      1F :                     
(1)   45/      1F :                     
(1)   46/      1F :                     ; =========================================================================================
(1)   47/      1F :                     ; Standard Call Procedure
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Initialize.asm) - Page 5 - 11/14/2020 15:50:57


(1)   48/      1F :                     ; as described in RCA CDP1802 User Manual, page 61
(1)   49/      1F :                     ; =========================================================================================
(1)   50/      1F : D3                  STC_Exit:                       SEP  R3
(1)   51/      20 : E2                  StdCall:                        SEX  R2
(1)   52/      21 : 96                                                  GHI  R6
(1)   53/      22 : 73                                                  STXD
(1)   54/      23 : 86                                                  GLO  R6
(1)   55/      24 : 73                                                  STXD
(1)   56/      25 : 93                                                  GHI  R3
(1)   57/      26 : B6                                                  PHI  R6
(1)   58/      27 : 83                                                  GLO  R3
(1)   59/      28 : A6                                                  PLO  R6
(1)   60/      29 : 46                                                  LDA  R6
(1)   61/      2A : B3                                                  PHI  R3
(1)   62/      2B : 46                                                  LDA  R6
(1)   63/      2C : A3                                                  PLO  R3
(1)   64/      2D : 30 1F                                               BR   STC_Exit
(1)   65/      2F :                     
(1)   66/      2F :                     ;------------------------------------------------------------------------------------------
(1)   67/      2F :                     
(1)   68/      2F :                     
(1)   69/      2F :                     ; =========================================================================================
(1)   70/      2F :                     ; Standard Return Procedure
(1)   71/      2F :                     ; as described in RCA CDP1802 User Manual, page 61
(1)   72/      2F :                     ; =========================================================================================
(1)   73/      2F : D3                  STR_Exit:                       SEP  R3
(1)   74/      30 : 96                  StdReturn                       GHI  R6
(1)   75/      31 : B3                                                  PHI  R3
(1)   76/      32 : 86                                                  GLO  R6
(1)   77/      33 : A3                                                  PLO  R3
(1)   78/      34 : E2                                                  SEX  R2
(1)   79/      35 : 12                                                  INC  R2
(1)   80/      36 : 72                                                  LDXA
(1)   81/      37 : A6                                                  PLO  R6
(1)   82/      38 : F0                                                  LDX
(1)   83/      39 : B6                                                  PHI  R6
(1)   84/      3A : 30 2F                                               BR   STR_Exit
(1)   85/      3C :                     
(1)   86/      3C :                     ;------------------------------------------------------------------------------------------
(1)   87/      3C :                     
(1)   88/      3C :                     
(1)   89/      3C :                     ; =========================================================================================
(1)   90/      3C :                     ; Simple delay loop
(1)   91/      3C :                     ;
(1)   92/      3C :                     ; Parameters:
(1)   93/      3C :                     ; RF.0                          Delay time
(1)   94/      3C :                     ; =========================================================================================
(1)   95/      3C : C4                  Delay:                          NOP
(1)   96/      3D : 2F                                                  DEC  RF
(1)   97/      3E : 8F                                                  GLO  RF
(1)   98/      3F : 3A 3C                                               BNZ  Delay
(1)   99/      41 : (MACRO)                                             RETURN
(1)   99/      41 : D5                          SEP R5
(1)  100/      42 :                     
(1)  101/      42 :                     ;------------------------------------------------------------------------------------------
(1)  102/      42 :                     
(1)  103/      42 :                     
(1)  104/      42 :                     ; =========================================================================================
(1)  105/      42 :                     ; Includes - Change order of compiling to jump target not on same page errors
(1)  106/      42 :                     ; =========================================================================================
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Initialize.asm) - Page 6 - 11/14/2020 15:50:57


(1)  107/      42 :                     
(1)  108/      42 :                                                     INCLUDE "Graphics1861.asm"
(2)    1/      42 :                     ; *****************************************************************************************
(2)    2/      42 :                     ; Copyright (c) 2020 
(2)    3/      42 :                     ; by Richard Dienstknecht
(2)    4/      42 :                     ;
(2)    5/      42 :                     ; Changes:
(2)    6/      42 :                     ; Gaston Williams, July, 2020 - Removed 64x128 Resolution logic
(2)    7/      42 :                     ; Gaston Williams, July, 2020 - Replaced Std Call and Std Return with Macros
(2)    8/      42 :                     ; Gaston Williams  Aug,  2020 - Added Macro for loading Register
(2)    9/      42 :                     ; Gaston Williams, Sept, 2020 - Restored 64x128 Resolution logic
(2)   10/      42 :                     ; Gaston Williams  Sept, 2020 - Updated DrawSprite logic for 64x128 resolution
(2)   11/      42 :                     ; *****************************************************************************************
(2)   12/      42 :                     
(2)   13/      42 : =>TRUE                                              IF UseGraphics == "TRUE"
(2)   14/      42 :                     
(2)   15/      42 :                     
(2)   16/      42 :                     ; =========================================================================================
(2)   17/      42 :                     ; Interrupt and DMA service routine for the CDP1861 to display an effective resolution
(2)   18/      42 :                     ; of 64 x 32 pixels, using a display buffer of 256 bytes.
(2)   19/      42 :                     ; =========================================================================================
(2)   20/      42 :                     
(2)   21/      42 : =>FALSE                                                     IF Resolution == "64x32"
(2)   22/      42 :                     
(2)   23/      42 :                     INT_Exit:                       LDXA
(2)   24/      42 :                                                             RET
(2)   25/      42 :                     DisplayInt:                     DEC  R2
(2)   26/      42 :                                                             SAV
(2)   27/      42 :                                                             DEC  R2
(2)   28/      42 :                                                             STR  R2
(2)   29/      42 :                                                             NOP
(2)   30/      42 :                                                             NOP
(2)   31/      42 :                                                             NOP
(2)   32/      42 :                     
(2)   33/      42 :                                                             IF BackBuffer <> "SWAP"
(2)   34/      42 :                                                             LDI  hi(DisplayBuffer)
(2)   35/      42 : [33]                                                        ENDIF
(2)   36/      42 :                     
(2)   37/      42 :                                                             IF BackBuffer == "SWAP"
(2)   38/      42 :                                                             GHI  R7
(2)   39/      42 : [37]                                                        ENDIF
(2)   40/      42 :                     
(2)   41/      42 :                                                             PHI  R0
(2)   42/      42 :                                                             LDI  00H
(2)   43/      42 :                                                             PLO  R0
(2)   44/      42 :                     INT_Loop:                       GLO  R0
(2)   45/      42 :                                                             SEX  R2
(2)   46/      42 :                                                             SEX  R2
(2)   47/      42 :                                                             DEC  R0
(2)   48/      42 :                                                             PLO  R0
(2)   49/      42 :                                                             SEX  R2
(2)   50/      42 :                                                             DEC  R0
(2)   51/      42 :                                                             PLO  R0
(2)   52/      42 :                                                             SEX  R2
(2)   53/      42 :                                                             DEC  R0
(2)   54/      42 :                                                             PLO  R0
(2)   55/      42 :                                                             BN1  INT_Loop
(2)   56/      42 :                                                             BR   INT_Exit
(2)   57/      42 :                     
(2)   58/      42 : [21]                                                        ENDIF
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 7 - 11/14/2020 15:50:57


(2)   59/      42 :                                                     
(2)   60/      42 :                     ;------------------------------------------------------------------------------------------
(2)   61/      42 :                     
(2)   62/      42 :                     
(2)   63/      42 :                     ; =========================================================================================
(2)   64/      42 :                     ; Interrupt and DMA service routine for the CDP1861 to display an effective resolution
(2)   65/      42 :                     ; of 64 x 64 pixels, using a display buffer of 512 bytes.
(2)   66/      42 :                     ; =========================================================================================
(2)   67/      42 :                     
(2)   68/      42 : =>TRUE                                                      IF Resolution == "64x64"
(2)   69/      42 :                     
(2)   70/      42 : 72                  INT_Exit:                       LDXA
(2)   71/      43 : 70                                                          RET
(2)   72/      44 : C4                  DisplayInt:                     NOP
(2)   73/      45 : 22                                                          DEC  R2
(2)   74/      46 : 78                                                          SAV
(2)   75/      47 : 22                                                          DEC  R2
(2)   76/      48 : 52                                                          STR  R2
(2)   77/      49 :                     
(2)   78/      49 : =>TRUE                                                      IF BackBuffer <> "SWAP"
(2)   79/      49 : F8 7D                                                       LDI  hi(DisplayBuffer)
(2)   80/      4B : [78]                                                        ENDIF
(2)   81/      4B :                     
(2)   82/      4B : =>FALSE                                                     IF BackBuffer == "SWAP"
(2)   83/      4B :                                                             GHI  R7
(2)   84/      4B : [82]                                                        ENDIF
(2)   85/      4B :                     
(2)   86/      4B : B0                                                          PHI  R0
(2)   87/      4C : F8 00                                                       LDI  00H
(2)   88/      4E : A0                                                          PLO  R0
(2)   89/      4F : C4                                                          NOP
(2)   90/      50 : C4                                                          NOP
(2)   91/      51 : E2                                                          SEX  R2
(2)   92/      52 : 80                  INT_Loop:                       GLO  R0
(2)   93/      53 : E2                                                          SEX  R2
(2)   94/      54 : 20                                                          DEC  R0
(2)   95/      55 : A0                                                          PLO  R0
(2)   96/      56 : E2                                                          SEX  R2
(2)   97/      57 : 3C 52                                                       BN1  INT_Loop
(2)   98/      59 : 80                  INT_Rest:                       GLO  R0
(2)   99/      5A : E2                                                          SEX  R2
(2)  100/      5B : 20                                                          DEC  R0
(2)  101/      5C : A0                                                          PLO  R0
(2)  102/      5D : 34 59                                                       B1   INT_Rest
(2)  103/      5F : 30 42                                                       BR   INT_Exit
(2)  104/      61 :                     
(2)  105/      61 : [68]                                                        ENDIF
(2)  106/      61 :                     
(2)  107/      61 :                     ;------------------------------------------------------------------------------------------
(2)  108/      61 :                     
(2)  109/      61 :                     
(2)  110/      61 :                     ; =========================================================================================
(2)  111/      61 :                     ; Interrupt and DMA service routine for the CDP1861 to display an effective resolution
(2)  112/      61 :                     ; of 64 x 128 pixels, using a display buffer of 1024 bytes.
(2)  113/      61 :                     ; =========================================================================================
(2)  114/      61 :                     
(2)  115/      61 : =>FALSE                                                     IF Resolution == "64x128"
(2)  116/      61 :                     
(2)  117/      61 :                     INT_Exit:                       LDXA
(2)  118/      61 :                                                             RET
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 8 - 11/14/2020 15:50:57


(2)  119/      61 :                     DisplayInt:                     NOP
(2)  120/      61 :                                                             DEC  R2
(2)  121/      61 :                                                             SAV
(2)  122/      61 :                                                             DEC  R2
(2)  123/      61 :                                                             STR  R2
(2)  124/      61 :                                                             SEX  R2                                 
(2)  125/      61 :                                                             SEX  R2
(2)  126/      61 :                                                             
(2)  127/      61 :                                                             IF BackBuffer <> "SWAP"
(2)  128/      61 :                                                             LDI  hi(DisplayBuffer)
(2)  129/      61 : [127]                                                       ENDIF
(2)  130/      61 :                     
(2)  131/      61 :                                                             IF BackBuffer == "SWAP"
(2)  132/      61 :                                                             GHI  R7
(2)  133/      61 : [131]                                                       ENDIF
(2)  134/      61 :                     
(2)  135/      61 :                                                             PHI  R0
(2)  136/      61 :                                                             LDI  00H
(2)  137/      61 :                                                             PLO  R0
(2)  138/      61 :                                                             BR   INT_Exit
(2)  139/      61 :                     
(2)  140/      61 : [115]                                                       ENDIF
(2)  141/      61 :                     
(2)  142/      61 :                     ;------------------------------------------------------------------------------------------
(2)  143/      61 :                     
(2)  144/      61 :                     
(2)  145/      61 :                     ; =========================================================================================
(2)  146/      61 :                     ; Parameters:
(2)  147/      61 :                     ; RF            Pointer to the image
(2)  148/      61 :                     ;
(2)  149/      61 :                     ; Internal:
(2)  150/      61 :                     ; RE            Pointer to video buffer
(2)  151/      61 :                     ; =========================================================================================
(2)  152/      61 :                     
(2)  153/      61 :                                                             
(2)  154/      61 : =>TRUE              CopyImage:                      IF BackBuffer == "OFF"
(2)  155/      61 : F8 7D                                                       LDI  hi(DisplayBuffer)                  ; prepare the pointer to the video buffer
(2)  156/      63 : BE                                                          PHI  RE
(2)  157/      64 : [154]                                                       ENDIF
(2)  158/      64 :                     
(2)  159/      64 : =>FALSE                                                     IF BackBuffer == "COPY"
(2)  160/      64 :                                                             LDI  hi(DoubleBuffer)                   ; prepare the pointer to the back buffer
(2)  161/      64 :                                                             PHI  RE
(2)  162/      64 : [159]                                                       ENDIF
(2)  163/      64 :                     
(2)  164/      64 : =>FALSE                                                     IF BackBuffer == "SWAP"
(2)  165/      64 :                                                             GLO  R7                                                 ; prepare the pointer to the current back buffer
(2)  166/      64 :                                                             PHI  RE
(2)  167/      64 : [164]                                                       ENDIF
(2)  168/      64 :                     
(2)  169/      64 : F8 00                                                       LDI  00H
(2)  170/      66 : AE                                                          PLO  RE
(2)  171/      67 :                     
(2)  172/      67 : 4F                  CI_Loop:                        LDA  RF
(2)  173/      68 : 5E                                                          STR  RE
(2)  174/      69 : 1E                                                          INC  RE
(2)  175/      6A : 8E                                                          GLO  RE
(2)  176/      6B : 3A 67                                                       BNZ  CI_Loop
(2)  177/      6D :                                                             
(2)  178/      6D : =>TRUE                                                      IF Resolution == "64x64"                                        
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 9 - 11/14/2020 15:50:57


(2)  179/      6D : =>TRUE                                                      IF BackBuffer == "OFF"
(2)  180/      6D : F8 7E                                                       LDI   hi(DisplayBuffer) + 1
(2)  181/      6F : [179]                                                       ENDIF
(2)  182/      6F :                     
(2)  183/      6F : =>FALSE                                                     IF BackBuffer == "COPY"
(2)  184/      6F :                                                             LDI   hi(DoubleBuffer) + 1
(2)  185/      6F : [183]                                                       ENDIF
(2)  186/      6F :                     
(2)  187/      6F : =>FALSE                                                     IF BackBuffer == "SWAP"
(2)  188/      6F :                                                             GLO  R7
(2)  189/      6F :                                                             ADI      01H
(2)  190/      6F : [187]                                                       ENDIF
(2)  191/      6F :                     
(2)  192/      6F : 52                                                          STR  R2
(2)  193/      70 : 9E                                                          GHI  RE
(2)  194/      71 : F5                                                          SD
(2)  195/      72 : 33 67                                                       BDF  CI_Loop                            
(2)  196/      74 : [178]                                                       ENDIF
(2)  197/      74 :                                                             
(2)  198/      74 : =>FALSE                                                     IF Resolution == "64x128"
(2)  199/      74 :                                                             IF BackBuffer == "OFF"
(2)  200/      74 :                                                             LDI   hi(DisplayBuffer) + 3
(2)  201/      74 : [199]                                                       ENDIF
(2)  202/      74 :                     
(2)  203/      74 :                                                             IF BackBuffer == "COPY"
(2)  204/      74 :                                                             LDI   hi(DoubleBuffer) + 3
(2)  205/      74 : [203]                                                       ENDIF
(2)  206/      74 :                     
(2)  207/      74 :                                                             IF BackBuffer == "SWAP"
(2)  208/      74 :                                                             GLO  R7
(2)  209/      74 :                                                             ADI  03H
(2)  210/      74 : [207]                                                       ENDIF
(2)  211/      74 :                     
(2)  212/      74 :                                                             STR  R2
(2)  213/      74 :                                                             GHI  RE
(2)  214/      74 :                                                             SD
(2)  215/      74 :                                                             BDF  CI_Loop                            
(2)  216/      74 : [198]                                                       ENDIF
(2)  217/      74 :                                                                                                                                     
(2)  218/      74 : (MACRO)                                                     RETURN                                  
(2)  218/      74 : D5                          SEP R5
(2)  219/      75 :                     
(2)  220/      75 :                     ;------------------------------------------------------------------------------------------
(2)  221/      75 :                     
(2)  222/      75 :                     
(2)  223/      75 :                     ; =========================================================================================
(2)  224/      75 :                     ; Parameters:
(2)  225/      75 :                     ; RF            Value for filling
(2)  226/      75 :                     ;
(2)  227/      75 :                     ; Internal:
(2)  228/      75 :                     ; RE            Pointer to video buffer
(2)  229/      75 :                     ; =========================================================================================
(2)  230/      75 :                     
(2)  231/      75 : =>TRUE              FillScreen:                     IF BackBuffer == "OFF"
(2)  232/      75 : F8 7D                                                       LDI  hi(DisplayBuffer)                  ; prepare the pointer to the video buffer
(2)  233/      77 : BE                                                          PHI  RE
(2)  234/      78 : [231]                                                       ENDIF
(2)  235/      78 :                     
(2)  236/      78 : =>FALSE                                                     IF BackBuffer == "COPY"
(2)  237/      78 :                                                             LDI  hi(DoubleBuffer)                   ; prepare the pointer to the back buffer
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 10 - 11/14/2020 15:50:57


(2)  238/      78 :                                                             PHI  RE
(2)  239/      78 : [236]                                                       ENDIF
(2)  240/      78 :                     
(2)  241/      78 : =>FALSE                                                     IF BackBuffer == "SWAP"
(2)  242/      78 :                                                             GLO  R7                                                 ; prepare the pointer to the current back buffer
(2)  243/      78 :                                                             PHI  RE
(2)  244/      78 : [241]                                                       ENDIF
(2)  245/      78 :                     
(2)  246/      78 : F8 00                                                       LDI  00H
(2)  247/      7A : AE                                                          PLO  RE
(2)  248/      7B :                     
(2)  249/      7B : 9F                  FS_Loop:                        GHI  RF
(2)  250/      7C : 5E                                                          STR  RE
(2)  251/      7D : 1E                                                          INC  RE
(2)  252/      7E : 8E                                                          GLO  RE
(2)  253/      7F : 3A 7B                                                       BNZ  FS_Loop
(2)  254/      81 :                                                             
(2)  255/      81 : =>TRUE                                                      IF Resolution == "64x64"
(2)  256/      81 : =>TRUE                                                      IF BackBuffer == "OFF"
(2)  257/      81 : F8 7E                                                       LDI   hi(DisplayBuffer) + 1
(2)  258/      83 : [256]                                                       ENDIF
(2)  259/      83 :                     
(2)  260/      83 : =>FALSE                                                     IF BackBuffer == "COPY"
(2)  261/      83 :                                                             LDI   hi(DoubleBuffer) + 1
(2)  262/      83 : [260]                                                       ENDIF
(2)  263/      83 :                     
(2)  264/      83 : =>FALSE                                                     IF BackBuffer == "SWAP"
(2)  265/      83 :                                                             GLO  R7
(2)  266/      83 :                                                             ADI  01H
(2)  267/      83 : [264]                                                       ENDIF
(2)  268/      83 :                     
(2)  269/      83 : 52                                                          STR  R2
(2)  270/      84 : 9E                                                          GHI  RE
(2)  271/      85 : F5                                                          SD
(2)  272/      86 : 33 7B                                                       BDF  FS_Loop                            
(2)  273/      88 : [255]                                                       ENDIF
(2)  274/      88 :                                                             
(2)  275/      88 : =>FALSE                                                     IF Resolution == "64x128"
(2)  276/      88 :                                                             IF BackBuffer == "OFF"
(2)  277/      88 :                                                             LDI   hi(DisplayBuffer) + 3
(2)  278/      88 : [276]                                                       ENDIF
(2)  279/      88 :                     
(2)  280/      88 :                                                             IF BackBuffer == "COPY"
(2)  281/      88 :                                                             LDI   hi(DoubleBuffer) + 3
(2)  282/      88 : [280]                                                       ENDIF
(2)  283/      88 :                     
(2)  284/      88 :                                                             IF BackBuffer == "SWAP"
(2)  285/      88 :                                                             GLO  R7
(2)  286/      88 :                                                             ADI  03H
(2)  287/      88 : [284]                                                       ENDIF
(2)  288/      88 :                     
(2)  289/      88 :                                                             STR  R2
(2)  290/      88 :                                                             GHI  RE
(2)  291/      88 :                                                             SD
(2)  292/      88 :                                                             BDF  FS_Loop                            
(2)  293/      88 : [275]                                                       ENDIF
(2)  294/      88 :                                                             
(2)  295/      88 : (MACRO)                                                     RETURN                                  
(2)  295/      88 : D5                          SEP R5
(2)  296/      89 :                     
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 11 - 11/14/2020 15:50:57


(2)  297/      89 :                     ;------------------------------------------------------------------------------------------
(2)  298/      89 :                     
(2)  299/      89 :                     
(2)  300/      89 :                     ; =========================================================================================
(2)  301/      89 :                     ; Parameters:
(2)  302/      89 :                     ; RE.0          X coordinate of the sprite
(2)  303/      89 :                     ; RE.1          Y coordinate of the sprite
(2)  304/      89 :                     ; RF            Pointer to sprite
(2)  305/      89 :                     ; RD            Size of the sprite in bytes
(2)  306/      89 :                     ;
(2)  307/      89 :                     ; Internal:
(2)  308/      89 :                     ; RC            Pointer to video memory
(2)  309/      89 :                     ; =========================================================================================
(2)  310/      89 :                     
(2)  311/      89 : =>TRUE              DrawSprite:                     IF BackBuffer == "OFF"
(2)  312/      89 : F8 7D                                                       LDI  hi(DisplayBuffer)          ; prepare the pointer to the video buffer
(2)  313/      8B : [311]                                                       ENDIF
(2)  314/      8B :                     
(2)  315/      8B : =>FALSE                                                     IF BackBuffer == "COPY"
(2)  316/      8B :                                                             LDI  hi(DoubleBuffer)           ; prepare the pointer to the back buffer
(2)  317/      8B : [315]                                                       ENDIF
(2)  318/      8B :                     
(2)  319/      8B : =>FALSE                                                     IF BackBuffer == "SWAP"
(2)  320/      8B :                                                             GLO  R7                         ; prepare the pointer to the current back buffer
(2)  321/      8B : [319]                                                       ENDIF
(2)  322/      8B :                                                             
(2)  323/      8B : BC                                                          PHI  RC                         ; DisplayBuffer + Y * 8 + X / 8
(2)  324/      8C : 9E                                                          GHI  RE                         ; result goes to RC
(2)  325/      8D :                     
(2)  326/      8D : =>FALSE                                                     IF Resolution == "64x32"
(2)  327/      8D :                                                             ANI  1FH                        ; between 0 - 31
(2)  328/      8D : [326]                                                       ENDIF
(2)  329/      8D :                                                     
(2)  330/      8D : =>TRUE                                                      IF Resolution == "64x64"
(2)  331/      8D : FA 3F                                                       ANI  3FH                        ; or 0 - 63
(2)  332/      8F : [330]                                                       ENDIF
(2)  333/      8F :                     
(2)  334/      8F : =>FALSE                                                     IF Resolution == "64x128"
(2)  335/      8F :                                                             ANI  7FH                        ; or 0 - 127
(2)  336/      8F : [334]                                                       ENDIF
(2)  337/      8F :                     
(2)  338/      8F : FE                                                          SHL                     ; after two shifts check 64x128 high bit in df
(2)  339/      90 : FE                                                          SHL                     ; df will always be zero for 64x64 and 64x32
(2)  340/      91 :                                                             
(2)  341/      91 : =>FALSE                                             IF Resolution == "64x128"
(2)  342/      91 :                                                             PLO  RC                 ; save low byte
(2)  343/      91 :                                                             BNF  DSP_SkipHighInc    ; df is high order bit of 64x128 count
(2)  344/      91 :                                                             GHI  RC                 ; get high byte
(2)  345/      91 :                                                             ADI  02H                ; df represents two's bit after shifting
(2)  346/      91 :                                                             PHI  RC                 ; update high byte
(2)  347/      91 :                     DSP_SkipHighInc:                        GLO  RC                 ; restore low byte and continue shifting
(2)  348/      91 : [341]                                               ENDIF
(2)  349/      91 : FE                                                          SHL                     
(2)  350/      92 : AC                                                          PLO  RC
(2)  351/      93 : 3B 99                                                       BNF  DSP_SkipLowInc
(2)  352/      95 : 9C                                                          GHI  RC
(2)  353/      96 : FC 01                                                       ADI  01H
(2)  354/      98 : BC                                                          PHI  RC
(2)  355/      99 :                                                             
(2)  356/      99 : 8C                  DSP_SkipLowInc:                 GLO  RC
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 12 - 11/14/2020 15:50:57


(2)  357/      9A : 52                                                          STR  R2
(2)  358/      9B : 8E                                                          GLO  RE
(2)  359/      9C : FA 3F                                                       ANI  3FH
(2)  360/      9E : F6                                                          SHR
(2)  361/      9F : F6                                                          SHR
(2)  362/      A0 : F6                                                          SHR
(2)  363/      A1 : F4                                                          ADD
(2)  364/      A2 : AC                                                          PLO  RC
(2)  365/      A3 : 8E                                                          GLO  RE                                 ; calculate the number of required shifts 
(2)  366/      A4 : FA 07                                                       ANI  07H                                ; result to RE.1, replacing the Y coordinate
(2)  367/      A6 : BE                                                          PHI  RE                                 ; RE.0 will be used later to count the shifts
(2)  368/      A7 :                     
(2)  369/      A7 : 8D                  DSP_ByteLoop:           GLO  RD                                                 ; exit if all bytes of the sprite have been drawn
(2)  370/      A8 : 32 D9                                                       BZ   DSP_Exit
(2)  371/      AA :                                                             
(2)  372/      AA : =>FALSE                                                     IF Resolution == "64x32"                ; or if we are about to draw outside the video buffer
(2)  373/      AA :                                                             IF BackBuffer == "OFF"
(2)  374/      AA :                                                             LDI   hi(DisplayBuffer)
(2)  375/      AA : [373]                                                       ENDIF
(2)  376/      AA :                     
(2)  377/      AA :                                                             IF BackBuffer == "COPY"
(2)  378/      AA :                                                             LDI   hi(DoubleBuffer)
(2)  379/      AA : [377]                                                       ENDIF
(2)  380/      AA :                     
(2)  381/      AA :                                                             IF BackBuffer == "SWAP"
(2)  382/      AA :                                                             GLO  R7
(2)  383/      AA : [381]                                                       ENDIF
(2)  384/      AA : [372]                                                       ENDIF
(2)  385/      AA :                     
(2)  386/      AA : =>TRUE                                                      IF Resolution == "64x64"
(2)  387/      AA : =>TRUE                                                      IF BackBuffer == "OFF"
(2)  388/      AA : F8 7E                                                       LDI   hi(DisplayBuffer) + 1
(2)  389/      AC : [387]                                                       ENDIF
(2)  390/      AC :                     
(2)  391/      AC : =>FALSE                                                     IF BackBuffer == "COPY"
(2)  392/      AC :                                                             LDI   hi(DoubleBuffer) + 1
(2)  393/      AC : [391]                                                       ENDIF
(2)  394/      AC :                     
(2)  395/      AC : =>FALSE                                                     IF BackBuffer == "SWAP"
(2)  396/      AC :                                                             GLO  R7
(2)  397/      AC :                                                             ADI  01H
(2)  398/      AC : [395]                                                       ENDIF
(2)  399/      AC : [386]                                                       ENDIF
(2)  400/      AC :                     
(2)  401/      AC : =>FALSE                                                     IF Resolution == "64x128"
(2)  402/      AC :                                                             IF BackBuffer == "OFF"
(2)  403/      AC :                                                             LDI   hi(DisplayBuffer) + 3
(2)  404/      AC : [402]                                                       ENDIF
(2)  405/      AC :                     
(2)  406/      AC :                                                             IF BackBuffer == "COPY"
(2)  407/      AC :                                                             LDI   hi(DoubleBuffer) + 3
(2)  408/      AC : [406]                                                       ENDIF
(2)  409/      AC :                     
(2)  410/      AC :                                                             IF BackBuffer == "SWAP"
(2)  411/      AC :                                                             GLO  R7
(2)  412/      AC :                                                             ADI      03H
(2)  413/      AC : [410]                                                       ENDIF
(2)  414/      AC : [401]                                                       ENDIF
(2)  415/      AC :                     
(2)  416/      AC : 52                                                          STR  R2
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 13 - 11/14/2020 15:50:57


(2)  417/      AD : 9C                                                          GHI  RC
(2)  418/      AE : F5                                                          SD
(2)  419/      AF : 3B D9                                                       BNF  DSP_Exit
(2)  420/      B1 : 0F                                                          LDN      RF                                                     ; load the next byte of the sprite into RB.0
(2)  421/      B2 : AB                                                          PLO  RB
(2)  422/      B3 : F8 00                                                       LDI  00H                                                ; set RB.1 to OOH
(2)  423/      B5 : BB                                                          PHI  RB
(2)  424/      B6 : 2D                                                          DEC  RD                                                 ; decrement the sprite's byte counter
(2)  425/      B7 : 1F                                                          INC  RF                                                 ; increment the pointer to the sprite's bytes
(2)  426/      B8 : 9E                                                          GHI  RE                                                 ; prepare the shift counter
(2)  427/      B9 : AE                                                          PLO  RE
(2)  428/      BA : 8E                  DSP_ShiftLoop:          GLO  RE                                                 ; exit the loop if all shifts have been performed
(2)  429/      BB : 32 C6                                                       BZ   DSP_ShiftExit
(2)  430/      BD : 2E                                                          DEC  RE                                                 ; decrement the shift counter
(2)  431/      BE : 8B                                                          GLO  RB                                                 ; shift the values in RB
(2)  432/      BF : F6                                                          SHR
(2)  433/      C0 : AB                                                          PLO  RB
(2)  434/      C1 : 9B                                                          GHI  RB
(2)  435/      C2 : 76                                                          RSHR
(2)  436/      C3 : BB                                                          PHI  RB
(2)  437/      C4 : 30 BA                                                       BR   DSP_ShiftLoop
(2)  438/      C6 : EC                  DSP_ShiftExit:          SEX  RC                                                 ; store the shifted bytes in the video buffer
(2)  439/      C7 : 8B                                                          GLO  RB
(2)  440/      C8 : F3                                                          XOR
(2)  441/      C9 : 5C                                                          STR  RC
(2)  442/      CA : 1C                                                          INC  RC
(2)  443/      CB : 9B                                                          GHI  RB
(2)  444/      CC : F3                                                          XOR
(2)  445/      CD : 5C                                                          STR  RC
(2)  446/      CE : E2                                                          SEX  R2
(2)  447/      CF : 8C                                                          GLO  RC                                                 ; advance the video buffer pointer to the next line
(2)  448/      D0 : FC 07                                                       ADI  07H
(2)  449/      D2 : AC                                                          PLO  RC
(2)  450/      D3 : 9C                                                          GHI  RC
(2)  451/      D4 : 7C 00                                                       ADCI 00H
(2)  452/      D6 : BC                                                          PHI  RC
(2)  453/      D7 : 30 A7                                                       BR   DSP_ByteLoop
(2)  454/      D9 : (MACRO)             DSP_Exit                        RETURN
(2)  454/      D9 : D5                          SEP R5
(2)  455/      DA :                     
(2)  456/      DA :                     ;------------------------------------------------------------------------------------------
(2)  457/      DA :                     
(2)  458/      DA :                     
(2)  459/      DA :                     ; =========================================================================================
(2)  460/      DA :                     ; Parameters:
(2)  461/      DA :                     ; ----
(2)  462/      DA :                     ;
(2)  463/      DA :                     ; Internal:
(2)  464/      DA :                     ; RE            Pointer to video buffer
(2)  465/      DA :                     ; RF            Pointer to back buffer
(2)  466/      DA :                     ; =========================================================================================
(2)  467/      DA :                                                             
(2)  468/      DA : =>FALSE             CopyBackBuffer:         IF BackBuffer <> "OFF"
(2)  469/      DA :                     
(2)  470/      DA :                                                             IF BackBuffer == "COPY"                                 
(2)  471/      DA :                                                             LOAD RE, DisplayBuffer                  ; prepare the pointer to the video buffer
(2)  472/      DA :                     
(2)  473/      DA :                                                             LOAD RF, DoubleBuffer                   ; prepare the pointer to the back buffer
(2)  474/      DA :                                                                                                     
(2)  475/      DA :                     CBB_Loop:                               LDA  RF
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Graphics1861.asm) - Page 14 - 11/14/2020 15:50:57


(2)  476/      DA :                                                             STR  RE
(2)  477/      DA :                                                             INC  RE
(2)  478/      DA :                                                             GLO  RE
(2)  479/      DA :                                                             BNZ  CBB_Loop
(2)  480/      DA :                                                             
(2)  481/      DA :                                                             IF Resolution == "64x64"
(2)  482/      DA :                                                             LDI   hi(DisplayBuffer) + 1
(2)  483/      DA : [481]                                                       ENDIF
(2)  484/      DA :                                                             
(2)  485/      DA :                                                             IF Resolution == "64x128"
(2)  486/      DA :                                                             LDI   hi(DisplayBuffer) + 3
(2)  487/      DA : [485]                                                       ENDIF
(2)  488/      DA :                     
(2)  489/      DA :                                                             STR  R2
(2)  490/      DA :                                                             GHI  RE
(2)  491/      DA :                                                             SD
(2)  492/      DA :                                                             BDF  CBB_Loop
(2)  493/      DA : [470]                                                       ENDIF
(2)  494/      DA :                     
(2)  495/      DA :                                                             IF BackBuffer == "SWAP"
(2)  496/      DA :                                                             GHI  R7
(2)  497/      DA :                                                             SMI  hi(DisplayBuffer)
(2)  498/      DA :                                                             BZ   CBB_Swap
(2)  499/      DA :                                                             LDI  hi(DisplayBuffer)
(2)  500/      DA :                                                             PHI  R7
(2)  501/      DA :                                                             LDI  hi(DoubleBuffer)
(2)  502/      DA :                                                             PLO  R7
(2)  503/      DA :                                                             BR   CBB_Exit
(2)  504/      DA :                     CBB_Swap:                       LDI  hi(DoubleBuffer)
(2)  505/      DA :                                                             PHI  R7
(2)  506/      DA :                                                             LDI  hi(DisplayBuffer)
(2)  507/      DA :                                                             PLO  R7
(2)  508/      DA :                                                             BR   CBB_Exit
(2)  509/      DA : [495]                                                       ENDIF
(2)  510/      DA :                     
(2)  511/      DA : [468]                                                       ENDIF                                   
(2)  512/      DA : (MACRO)             CBB_Exit:                       RETURN          
(2)  512/      DA : D5                          SEP R5
(2)  513/      DB :                     
(2)  514/      DB :                     ;------------------------------------------------------------------------------------------
(2)  515/      DB :                     
(2)  516/      DB : [13]                                                ENDIF
(2)  517/      DB :                     
(1)  109/      DB :                     
(1)  110/      DB : =>FALSE                             IF Resolution == "64x128"
(1)  111/      DB :                                             IF BackBuffer == "OFF"
(1)  112/      DB :                                                     INCLUDE "Text1861.asm"
(1)  113/      DB :                                                     INCLUDE "Fonts.asm"
(1)  114/      DB :                                             ELSEIF
(1)  115/      DB :                                                     INCLUDE "Fonts.asm"
(1)  116/      DB :                                                     INCLUDE "Text1861.asm"
(1)  117/      DB : [111]                                       ENDIF
(1)  118/      DB :                                                     INCLUDE "Tty1861.asm"
(1)  119/      DB : [110]                               ENDIF
(1)  120/      DB :                     
(1)  121/      DB : =>TRUE                              IF Resolution == "64x64"
(1)  122/      DB : =>TRUE                                      IF BackBuffer == "OFF"
(1)  123/      DB :                                                     INCLUDE "Text1861.asm"
(2)    1/      DB :                     ; *****************************************************************************************
(2)    2/      DB :                     ; Copyright (c) 2020 
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Text1861.asm) - Page 15 - 11/14/2020 15:50:57


(2)    3/      DB :                     ; by Richard Dienstknecht
(2)    4/      DB :                     ;
(2)    5/      DB :                     ; Changes:
(2)    6/      DB :                     ; Gaston Williams, July, 2020 - Moved Font definitions into separate file
(2)    7/      DB :                     ; Gaston Williams, July, 2020 - Replaced Std Call and Std Return with Macros
(2)    8/      DB :                     ; Gaston Williams  Aug,  2020 - Added Macro for loading Register
(2)    9/      DB :                     ; *****************************************************************************************
(2)   10/      DB :                     
(2)   11/      DB : =>TRUE                              IF UseText == "TRUE"
(2)   12/      DB :                     
(2)   13/      DB :                     ; =========================================================================================
(2)   14/      DB :                     ; Draws a zero terminated string at specified screen coordinates. 
(2)   15/      DB :                     ;
(2)   16/      DB :                     ; Parameters:
(2)   17/      DB :                     ; RF            Pointer to the string
(2)   18/      DB :                     ; RE.0          X coordinate
(2)   19/      DB :                     ; RE.1          Y coordinate
(2)   20/      DB :                     ; =========================================================================================
(2)   21/      DB :                     
(2)   22/      DB : 0F                  DrawString:             LDN  RF                 ; get character, exit if 0
(2)   23/      DC : AC                                          PLO  RC
(2)   24/      DD : 32 FF                                       BZ   DS_Exit
(2)   25/      DF : 1F                                          INC  RF
(2)   26/      E0 :                                                             
(2)   27/      E0 : 8F                                          GLO  RF                 ; push RF onto the stack
(2)   28/      E1 : 73                                          STXD
(2)   29/      E2 : 9F                                          GHI  RF
(2)   30/      E3 : 73                                          STXD
(2)   31/      E4 :                                                             
(2)   32/      E4 : 8E                                          GLO  RE                 ; push RE onto the stack
(2)   33/      E5 : 73                                          STXD
(2)   34/      E6 : 9E                                          GHI  RE
(2)   35/      E7 : 73                                          STXD
(2)   36/      E8 :                                                             
(2)   37/      E8 : (MACRO)                                     CALL DrawCharacter      ; draw the character
(2)   37/      E8 : D4                          SEP R4
(2)   37/      E9 : 01 00                       dw  DRAWCHARACTER
(2)   38/      EB :                                                             
(2)   39/      EB : 60                                          IRX                     ; restore RE
(2)   40/      EC : 72                                          LDXA
(2)   41/      ED : BE                                          PHI  RE
(2)   42/      EE : F0                                          LDX
(2)   43/      EF : AE                                          PLO  RE
(2)   44/      F0 :                                                             
(2)   45/      F0 : 8F                                          GLO  RF                 ; advance the x coordinate by the
(2)   46/      F1 : 73                                          STXD                    ; width of the character + 1
(2)   47/      F2 : 60                                          IRX
(2)   48/      F3 : 8E                                          GLO  RE
(2)   49/      F4 : F4                                          ADD
(2)   50/      F5 : FC 01                                       ADI  01H
(2)   51/      F7 : AE                                          PLO  RE
(2)   52/      F8 :                                             
(2)   53/      F8 : 60                                          IRX                     ; restore RF
(2)   54/      F9 : 72                                          LDXA
(2)   55/      FA : BF                                          PHI  RF
(2)   56/      FB : F0                                          LDX
(2)   57/      FC : AF                                          PLO  RF
(2)   58/      FD : 30 DB                                       BR   DrawString         ; continue with the next character
(2)   59/      FF :                     
(2)   60/      FF : (MACRO)             DS_Exit:                RETURN
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Text1861.asm) - Page 16 - 11/14/2020 15:50:57


(2)   60/      FF : D5                          SEP R5
(2)   61/     100 :                     
(2)   62/     100 :                     ;------------------------------------------------------------------------------------------
(2)   63/     100 :                     
(2)   64/     100 :                     
(2)   65/     100 :                     ; =========================================================================================
(2)   66/     100 :                     ; Draws a character at specified screen coordinates 
(2)   67/     100 :                     ;
(2)   68/     100 :                     ; Parameters:
(2)   69/     100 :                     ; RE.0          X coordinate of the character
(2)   70/     100 :                     ; RE.1          Y coordinate of the character
(2)   71/     100 :                     ; RC.0          ASCII code of the character (20 - 7F)
(2)   72/     100 :                     ; 
(2)   73/     100 :                     ; Internal:
(2)   74/     100 :                     ; RF            Pointer to the unpacked character's pattern
(2)   75/     100 :                     ; RD            Pointer to the font
(2)   76/     100 :                     ; RC.1          Temporary values
(2)   77/     100 :                     
(2)   78/     100 :                     ; Returns:
(2)   79/     100 :                     ; RF.0          Character width
(2)   80/     100 :                     ; =========================================================================================
(2)   81/     100 :                     
(2)   82/     100 : (MACRO)             DrawCharacter:          LOAD RF, CharacterPattern       ; RF points to the buffer for the character pattern
(2)   82/     100 : F8 00                       LDI  lo(CHARACTERPATTERN)
(2)   82/     102 : AF                          PLO  RF
(2)   82/     103 : F8 7F                       LDI  hi(CHARACTERPATTERN)
(2)   82/     105 : BF                          PHI  RF     
(2)   83/     106 :                                                                                     
(2)   84/     106 : (MACRO)                                     LOAD RD, Font                   ; RD points to the font                 
(2)   84/     106 : F8 7C                       LDI  lo(FONT)
(2)   84/     108 : AD                          PLO  RD
(2)   84/     109 : F8 01                       LDI  hi(FONT)
(2)   84/     10B : BD                          PHI  RD     
(2)   85/     10C :                                                     
(2)   86/     10C : 8C                                          GLO  RC                         ; calculate the offset in the font
(2)   87/     10D : FF 20                                       SMI  020H                       ; (( character code - 20) / 2) * 6
(2)   88/     10F : FA FE                                       ANI  0FEH
(2)   89/     111 : BC                                          PHI  RC
(2)   90/     112 : FE                                          SHL
(2)   91/     113 : 73                                          STXD
(2)   92/     114 : 60                                          IRX                                     
(2)   93/     115 : 9C                                          GHI  RC
(2)   94/     116 : F4                                          ADD
(2)   95/     117 : 73                                          STXD
(2)   96/     118 : 60                                          IRX
(2)   97/     119 : 3B 1F                                       BNF  DC_SkipHighByte
(2)   98/     11B : 9D                                          GHI  RD
(2)   99/     11C : FC 01                                       ADI      01H
(2)  100/     11E : BD                                          PHI  RD
(2)  101/     11F :                                                             
(2)  102/     11F : 8D                  DC_SkipHighByte:        GLO  RD                         ; add to the address in RD
(2)  103/     120 : F4                                          ADD     
(2)  104/     121 : AD                                          PLO  RD
(2)  105/     122 : 3B 28                                       BNF  DC_SkipHighByte2
(2)  106/     124 : 9D                                          GHI  RD
(2)  107/     125 : FC 01                                       ADI  01H
(2)  108/     127 : BD                                          PHI  RD
(2)  109/     128 :                     
(2)  110/     128 : 0D                  DC_SkipHighByte2:       LDN  RD                         ; get the width of the first character pattern
(2)  111/     129 : F6                                          SHR
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Text1861.asm) - Page 17 - 11/14/2020 15:50:57


(2)  112/     12A : F6                                          SHR
(2)  113/     12B : F6                                          SHR
(2)  114/     12C : F6                                          SHR
(2)  115/     12D : 73                                          STXD
(2)  116/     12E : 60                                          IRX
(2)  117/     12F :                     
(2)  118/     12F : 8C                                          GLO  RC                         ; do we need the first or the second pattern?
(2)  119/     130 : FA 01                                       ANI  01H
(2)  120/     132 : BC                                          PHI  RC
(2)  121/     133 : 3A 47                                       BNZ  DC_PrepareSecond
(2)  122/     135 :                                                             
(2)  123/     135 : F0                                          LDX                             ; prepare the mask                                      
(2)  124/     136 : AB                                          PLO  RB 
(2)  125/     137 : F8 00                                       LDI  00H
(2)  126/     139 : BB                                          PHI  RB
(2)  127/     13A : 9B                  DC_MaskLoop:            GHI  RB
(2)  128/     13B : F6                                          SHR
(2)  129/     13C : F9 80                                       ORI  80H
(2)  130/     13E : BB                                          PHI  RB
(2)  131/     13F : 2B                                          DEC  RB
(2)  132/     140 : 8B                                          GLO  RB
(2)  133/     141 : 3A 3A                                       BNZ  DC_MaskLoop
(2)  134/     143 :                     
(2)  135/     143 : F0                                          LDX
(2)  136/     144 : 73                                          STXD                            ; keep the width of the first pattern on the stack
(2)  137/     145 : 30 4D                                       BR   DC_CopyPattern
(2)  138/     147 :                     
(2)  139/     147 : F0                  DC_PrepareSecond:       LDX                             ; use the width of the first pattern for shifting
(2)  140/     148 : BB                                          PHI  RB
(2)  141/     149 :                     
(2)  142/     149 : 0D                                          LDN  RD                         ; keep the width of the second character pattern on the stack
(2)  143/     14A : FA 07                                       ANI  07H
(2)  144/     14C : 73                                          STXD
(2)  145/     14D :                     
(2)  146/     14D : 1D                  DC_CopyPattern:         INC  RD
(2)  147/     14E : F8 05                                       LDI  05H                        ; prepare a loop over the five bytes of the pattern
(2)  148/     150 : AC                                          PLO  RC
(2)  149/     151 :                                                             
(2)  150/     151 : 0D                  DC_ByteLoop:            LDN  RD                         ; get a byte from the font
(2)  151/     152 : 73                                          STXD
(2)  152/     153 : 60                                          IRX
(2)  153/     154 : 1D                                          INC  RD
(2)  154/     155 :                                                             
(2)  155/     155 : 9C                                          GHI  RC
(2)  156/     156 : 3A 5E                                       BNZ  DC_ByteShift
(2)  157/     158 :                     
(2)  158/     158 : 9B                                          GHI  RB                         ; mask out the first pattern
(2)  159/     159 : F2                                          AND
(2)  160/     15A : 73                                          STXD
(2)  161/     15B : 60                                          IRX
(2)  162/     15C : 30 68                                       BR   DC_ByteWrite
(2)  163/     15E :                     
(2)  164/     15E : 9B                  DC_ByteShift:           GHI  RB                         ; shift the second pattern
(2)  165/     15F : AB                                          PLO  RB
(2)  166/     160 : F0                  DC_ShiftLoop:           LDX
(2)  167/     161 : FE                                          SHL
(2)  168/     162 : 73                                          STXD
(2)  169/     163 : 60                                          IRX
(2)  170/     164 : 2B                                          DEC  RB
(2)  171/     165 : 8B                                          GLO  RB
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Text1861.asm) - Page 18 - 11/14/2020 15:50:57


(2)  172/     166 : 3A 60                                       BNZ  DC_ShiftLoop
(2)  173/     168 :                     
(2)  174/     168 : F0                  DC_ByteWrite:           LDX                             ; write the byte
(2)  175/     169 : 5F                                          STR  RF
(2)  176/     16A : 1F                                          INC  RF
(2)  177/     16B :                     
(2)  178/     16B : 2C                                          DEC  RC                         ; continue until all bytes of the pattern are done
(2)  179/     16C : 8C                                          GLO  RC
(2)  180/     16D : 3A 51                                       BNZ  DC_ByteLoop
(2)  181/     16F :                     
(2)  182/     16F : F8 00                                       LDI  lo(CharacterPattern)       ; restore RF to the beginning of the pattern
(2)  183/     171 : AF                                          PLO  RF
(2)  184/     172 : F8 05                                       LDI  05H                        ; set the length of the pattern
(2)  185/     174 : AD                                          PLO  RD
(2)  186/     175 : (MACRO)                                     CALL DrawSprite                 ; call sprite routine to draw                   
(2)  186/     175 : D4                          SEP R4
(2)  186/     176 : 00 89                       dw  DRAWSPRITE
(2)  187/     178 :                     
(2)  188/     178 : 60                                          IRX                             ; clean up and exit
(2)  189/     179 : F0                                          LDX
(2)  190/     17A : AF                                          PLO  RF
(2)  191/     17B : (MACRO)                                     RETURN
(2)  191/     17B : D5                          SEP R5
(2)  192/     17C :                     
(2)  193/     17C :                     ;------------------------------------------------------------------------------------------
(2)  194/     17C : [11]                                ENDIF
(1)  124/     17C :                                                     INCLUDE "Fonts.asm"
(2)    1/     17C :                     
(2)    2/     17C :                     ; *********************************************************************************************
(2)    3/     17C :                     ; Copyright (c) 2020 
(2)    4/     17C :                     ; by Richard Dienstknecht
(2)    5/     17C :                     ;
(2)    6/     17C :                     ; Changes:
(2)    7/     17C :                     ; Gaston Williams, July, 2020 - Put Font definations into separate file 
(2)    8/     17C :                     ; Gaston Williams, August, 2020 - Changed DEL to 1 pixel wide space
(2)    9/     17C :                     ;
(2)   10/     17C :                     ; Font definition
(2)   11/     17C :                     ;
(2)   12/     17C :                     ; The font has 96 printable characters, and requires 288 bytes of memory.
(2)   13/     17C :                     ;
(2)   14/     17C :                     ; The characters are encoded in standard ASCII, beginning with 20H and ending at 7FH. Each
(2)   15/     17C :                     ; character has a height of 5 pixels and a variable width of 1 - 5 pixels. 
(2)   16/     17C :                     ;
(2)   17/     17C :                     ; In order to save memory, the patterns of two characters have been combined into one. Without
(2)   18/     17C :                     ; this, the complete 96 character font would have required 480 bytes. The 'left' character
(2)   19/     17C :                     ; stands for the lower even ASCII code, the 'right' one for the following
(2)   20/     17C :                     ; uneven ASCII code. The DrawCharacter subroutine will either mask the left character or
(2)   21/     17C :                     ; shift the right one over to the position of the left one when a character is drawn.
(2)   22/     17C :                     ;
(2)   23/     17C :                     ; Each line defines two characters of variable width, together no more than 8 pixels. The
(2)   24/     17C :                     ; first byte contains the width of each character. The upper four bits hold the width of
(2)   25/     17C :                     ; the left character in the pattern, the lower four bits hold the width of the right character.
(2)   26/     17C :                     ;
(2)   27/     17C :                     ; The following five bytes contain the bit patterns of the characters. Beginning at the left
(2)   28/     17C :                     ; (most significant) bit, the pattern of the left character (up to its specified width) is 
(2)   29/     17C :                     ; immediately followed by the bits of the right character. Any remaining bits to the right 
(2)   30/     17C :                     ; (if both characters together are less than 8 pixels wide) must be set to 0. 
(2)   31/     17C :                     ; **********************************************************************************************
(2)   32/     17C :                     
(2)   33/     17C : 11 40 40 40 00 40   Font:           db  0011H, 0040H, 0040H, 0040H, 0000H, 0040H            ; space and !
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Fonts.asm) - Page 19 - 11/14/2020 15:50:57


(2)   34/     182 : 35 AA BF 0A 1F 0A                   db  0035H, 00AAH, 00BFH, 000AH, 001FH, 000AH            ; " and #
(2)   35/     188 : 33 74 C4 48 70 D4                   db  0033H, 0074H, 00C4H, 0048H, 0070H, 00D4H            ; $ and %
(2)   36/     18E : 41 48 A8 40 A0 D0                   db  0041H, 0048H, 00A8H, 0040H, 00A0H, 00D0H            ; & and '
(2)   37/     194 : 22 60 90 90 90 60                   db  0022H, 0060H, 0090H, 0090H, 0090H, 0060H            ; ( and )
(2)   38/     19A : 33 00 A8 5C A8 00                   db  0033H, 0000H, 00A8H, 005CH, 00A8H, 0000H            ; * and +
(2)   39/     1A0 : 22 00 00 30 40 80                   db  0022H, 0000H, 0000H, 0030H, 0040H, 0080H            ; , and -
(2)   40/     1A6 : 13 10 10 20 40 C0                   db  0013H, 0010H, 0010H, 0020H, 0040H, 00C0H            ; . and /
(2)   41/     1AC : 33 48 B8 A8 A8 5C                   db  0033H, 0048H, 00B8H, 00A8H, 00A8H, 005CH            ; 0 and 1
(2)   42/     1B2 : 33 D8 24 48 84 F8                   db  0033H, 00D8H, 0024H, 0048H, 0084H, 00F8H            ; 2 and 3
(2)   43/     1B8 : 33 3C B0 F8 24 38                   db  0033H, 003CH, 00B0H, 00F8H, 0024H, 0038H            ; 4 and 5
(2)   44/     1BE : 33 5C 84 C4 A8 48                   db  0033H, 005CH, 0084H, 00C4H, 00A8H, 0048H            ; 6 and 7               
(2)   45/     1C4 : 33 48 B4 4C A4 48                   db  0033H, 0048H, 00B4H, 004CH, 00A4H, 0048H            ; 8 and 9
(2)   46/     1CA : 12 00 20 80 20 C0                   db  0012H, 0000H, 0020H, 0080H, 0020H, 00C0H            ; : and ;               
(2)   47/     1D0 : 32 20 58 80 58 20                   db  0032H, 0020H, 0058H, 0080H, 0058H, 0020H            ; < and =
(2)   48/     1D6 : 33 88 54 24 48 88                   db  0033H, 0088H, 0054H, 0024H, 0048H, 0088H            ; > and ?
(2)   49/     1DC : 33 48 F4 9C B4 54                   db  0033H, 0048H, 00F4H, 009CH, 00B4H, 0054H            ; @ and A
(2)   50/     1E2 : 33 CC B0 D0 B0 CC                   db  0033H, 00CCH, 00B0H, 00D0H, 00B0H, 00CCH            ; B and C
(2)   51/     1E8 : 33 DC B0 B8 B0 DC                   db  0033H, 00DCH, 00B0H, 00B8H, 00B0H, 00DCH            ; D and E
(2)   52/     1EE : 33 EC 90 D0 94 8C                   db  0033H, 00ECH, 0090H, 00D0H, 0094H, 008CH            ; F and G
(2)   53/     1F4 : 33 BC A8 E8 A8 BC                   db  0033H, 00BCH, 00A8H, 00E8H, 00A8H, 00BCH            ; H and I
(2)   54/     1FA : 33 34 34 38 B4 54                   db  0033H, 0034H, 0034H, 0038H, 00B4H, 0054H            ; J and K
(2)   55/     200 : 35 91 9B 95 91 F1                   db  0035H, 0091H, 009BH, 0095H, 0091H, 00F1H            ; L and M
(2)   56/     206 : 43 9E DA BA 9A 9E                   db  0043H, 009EH, 00DAH, 00BAH, 009AH, 009EH            ; N and O
(2)   57/     20C : 34 DE B2 D2 96 9E                   db  0034H, 00DEH, 00B2H, 00D2H, 0096H, 009EH            ; P and Q
(2)   58/     212 : 33 CC B0 C8 A4 B8                   db  0033H, 00CCH, 00B0H, 00C8H, 00A4H, 00B8H            ; R and S
(2)   59/     218 : 33 F4 54 54 54 5C                   db  0033H, 00F4H, 0054H, 0054H, 0054H, 005CH            ; T and U
(2)   60/     21E : 35 B1 B1 B1 B5 4A                   db  0035H, 00B1H, 00B1H, 00B1H, 00B5H, 004AH            ; V and W
(2)   61/     224 : 33 B4 B4 48 A8 A8                   db  0033H, 00B4H, 00B4H, 0048H, 00A8H, 00A8H            ; X and Y
(2)   62/     22A : 32 F8 30 50 90 F8                   db  0032H, 00F8H, 0030H, 0050H, 0090H, 00F8H            ; Z and [
(2)   63/     230 : 32 98 88 48 28 38                   db  0032H, 0098H, 0088H, 0048H, 0028H, 0038H            ; \ and ]
(2)   64/     236 : 33 40 A0 00 00 1C                   db  0033H, 0040H, 00A0H, 0000H, 0000H, 001CH            ; ^ and _
(2)   65/     23C : 23 40 98 28 28 18                   db  0023H, 0040H, 0098H, 0028H, 0028H, 0018H            ; ' and a
(2)   66/     242 : 33 80 CC B0 B0 CC                   db  0033H, 0080H, 00CCH, 00B0H, 00B0H, 00CCH            ; b and c
(2)   67/     248 : 33 20 6C B4 B8 6C                   db  0033H, 0020H, 006CH, 00B4H, 00B8H, 006CH            ; d and e
(2)   68/     24E : 23 58 A8 F0 88 B0                   db  0023H, 0058H, 00A8H, 00F0H, 0088H, 00B0H            ; f and g
(2)   69/     254 : 31 90 80 D0 B0 B0                   db  0031H, 0090H, 0080H, 00D0H, 00B0H, 00B0H            ; h and i
(2)   70/     25A : 23 60 28 70 68 A8                   db  0023H, 0060H, 0028H, 0070H, 0068H, 00A8H            ; j and k
(2)   71/     260 : 25 80 94 AA AA 6A                   db  0025H, 0080H, 0094H, 00AAH, 00AAH, 006AH            ; l and m
(2)   72/     266 : 33 00 C8 B4 B4 A8                   db  0033H, 0000H, 00C8H, 00B4H, 00B4H, 00A8H            ; n and o
(2)   73/     26C : 33 00 CC B4 CC 84                   db  0033H, 0000H, 00CCH, 00B4H, 00CCH, 0084H            ; p and q
(2)   74/     272 : 23 00 58 B0 88 B0                   db  0023H, 0000H, 0058H, 00B0H, 0088H, 00B0H            ; r and s
(2)   75/     278 : 23 80 E8 A8 A8 58                   db  0023H, 0080H, 00E8H, 00A8H, 00A8H, 0058H            ; t and u
(2)   76/     27E : 35 00 B1 B5 B5 4A                   db  0035H, 0000H, 00B1H, 00B5H, 00B5H, 004AH            ; v and w
(2)   77/     284 : 33 00 B4 4C 44 A8                   db  0033H, 0000H, 00B4H, 004CH, 0044H, 00A8H            ; x and y
(2)   78/     28A : 33 0C E8 30 48 EC                   db  0033H, 000CH, 00E8H, 0030H, 0048H, 00ECH            ; z and {
(2)   79/     290 : 13 E0 A0 90 A0 E0                   db  0013H, 00E0H, 00A0H, 0090H, 00A0H, 00E0H            ; | and }
(2)   80/     296 : 41 00 50 A0 00 00                   db  0041H, 0000H, 0050H, 00A0H, 0000H, 0000H            ; ~ and DEL
(2)   81/     29C :                     ;------------------------------------------------------------------------------------------
(1)  125/     29C : =>FALSE                                     ELSEIF
(1)  126/     29C :                                                     INCLUDE "Fonts.asm"
(1)  127/     29C :                                                     INCLUDE "Text1861.asm"
(1)  128/     29C : [122]                                       ENDIF
(1)  129/     29C :                                                     INCLUDE "Tty1861.asm"
(2)    1/     29C :                     ; *******************************************************************************************
(2)    2/     29C :                     ; Tty1861 - Teletype Terminal functions
(2)    3/     29C :                     ; Copyright (c) 2020 by Gaston Williams
(2)    4/     29C :                     ;
(2)    5/     29C :                     ; These functions implement basic terminal functions in 64x64 bit graphics.
(2)    6/     29C :                     
(2)    7/     29C :                     ; Notes: 
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 20 - 11/14/2020 15:50:57


(2)    8/     29C :                     ;       1. Functions named with "Get" or "Put" are safe functions that check before updating
(2)    9/     29C :                     ;       and those named with "Read" or "Write" may not be safe, and the caller is responsible
(2)   10/     29C :                     ;       for checking to see if it's safe before calling them update the video data.
(2)   11/     29C :                     ;
(2)   12/     29C :                     ;       2. BeginTerminal should be called before any video, and the VideoOn and VideoOff 
(2)   13/     29C :                     ;       functions should be used to turn the 1861 on and off.
(2)   14/     29C :                     ;
(2)   15/     29C :                     ;       3. The WaitForSafeUpdate function can be used to check for the end of Video DMA 
(2)   16/     29C :                     ;       when it is safe to update video data.
(2)   17/     29C :                     ;
(2)   18/     29C :                     ; Changes:
(2)   19/     29C :                     ; Gaston Williams, Sept, 2020 - Added 64 x 128 Resolution logic
(2)   20/     29C :                     ; Gaston Williams, Nov,  2020 - Added support for EOT to clear screen
(2)   21/     29C :                     ; *******************************************************************************************
(2)   22/     29C :                     
(2)   23/     29C : =>TRUE                                      IF UseTty == "TRUE"
(2)   24/     29C :                                                     
(2)   25/     29C :                     ; =========================================================================================
(2)   26/     29C :                     ; Initialize system variables for TTY Terminal
(2)   27/     29C :                     ;
(2)   28/     29C :                     ; Note: *** MANDATORY *** This function must be called before any other Terminal functions
(2)   29/     29C :                     ;
(2)   30/     29C :                     ; Internal:
(2)   31/     29C :                     ; RF.0          Value to set Video Flag false
(2)   32/     29C :                     ; =========================================================================================
(2)   33/     29C :                     
(2)   34/     29C : E2                  BeginTerminal:          SEX  R2                 ; make sure X points to stack pointer
(2)   35/     29D :                                             
(2)   36/     29D : F8 00                                       LDI  00H                ; set the video flag to false
(2)   37/     29F : AF                                          PLO  RF                                         
(2)   38/     2A0 : (MACRO)                                     CALL SetVideoFlag
(2)   38/     2A0 : D4                          SEP R4
(2)   38/     2A1 : 02 F5                       dw  SETVIDEOFLAG
(2)   39/     2A3 :                                                                     
(2)   40/     2A3 : (MACRO)                                     CALL ClearScreen        ; set cursor to home
(2)   40/     2A3 : D4                          SEP R4
(2)   40/     2A4 : 03 E7                       dw  CLEARSCREEN
(2)   41/     2A6 :                                             
(2)   42/     2A6 : =>FALSE                             IF BackBuffer <> "OFF"
(2)   43/     2A6 :                                             CALL CopyBackBuffer     ; clear second video buffer
(2)   44/     2A6 : [42]                                ENDIF
(2)   45/     2A6 :                     
(2)   46/     2A6 :                                                                             
(2)   47/     2A6 : (MACRO)                                     RETURN                  
(2)   47/     2A6 : D5                          SEP R5
(2)   48/     2A7 :                     ;------------------------------------------------------------------------------------------
(2)   49/     2A7 :                     
(2)   50/     2A7 :                     ; =========================================================================================
(2)   51/     2A7 :                     ; VideoOn - Turn pixie video on and set the flag
(2)   52/     2A7 :                     ;
(2)   53/     2A7 :                     ; Note: *** MANDATORY *** This function must be used to turn the video on
(2)   54/     2A7 :                     ;
(2)   55/     2A7 :                     ; Internal:
(2)   56/     2A7 :                     ; RF.0          Value to set Video Flag true
(2)   57/     2A7 :                     ; =========================================================================================
(2)   58/     2A7 :                     
(2)   59/     2A7 : 69                  VideoOn:                INP 1                   ; turn 1861 video on
(2)   60/     2A8 :                                                                     
(2)   61/     2A8 : F8 FF                                       LDI  00FFH              ; set video flag to true (-1)
(2)   62/     2AA : AF                                          PLO  RF
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 21 - 11/14/2020 15:50:57


(2)   63/     2AB : (MACRO)                                     CALL SetVideoFlag       
(2)   63/     2AB : D4                          SEP R4
(2)   63/     2AC : 02 F5                       dw  SETVIDEOFLAG
(2)   64/     2AE :                                     
(2)   65/     2AE : (MACRO)                                     RETURN
(2)   65/     2AE : D5                          SEP R5
(2)   66/     2AF :                     ;------------------------------------------------------------------------------------------
(2)   67/     2AF :                     
(2)   68/     2AF :                     ; =========================================================================================
(2)   69/     2AF :                     ; VideoOff - Turn pixie video off and clear the flag
(2)   70/     2AF :                     ;
(2)   71/     2AF :                     ; Note: *** MANDATORY *** This function must be used to turn the video off
(2)   72/     2AF :                     ;
(2)   73/     2AF :                     ; Internal:
(2)   74/     2AF :                     ; RD            Pointer to video flag
(2)   75/     2AF :                     ; =========================================================================================
(2)   76/     2AF :                     
(2)   77/     2AF : 61                  VideoOff:               OUT 1                   ; turn 1861 video off
(2)   78/     2B0 :                     
(2)   79/     2B0 : 22                                          DEC  R2                 ; The output instruction increments stack
(2)   80/     2B1 :                                                                     ; pointer, so back up the stack pointer to
(2)   81/     2B1 :                                                                     ; point to its previous location.
(2)   82/     2B1 :                                                                     
(2)   83/     2B1 : F8 00                                       LDI  00H                ; set the video flag to false
(2)   84/     2B3 : AF                                          PLO  RF                                         
(2)   85/     2B4 : (MACRO)                                     CALL SetVideoFlag
(2)   85/     2B4 : D4                          SEP R4
(2)   85/     2B5 : 02 F5                       dw  SETVIDEOFLAG
(2)   86/     2B7 :                                     
(2)   87/     2B7 : (MACRO)                                     RETURN
(2)   87/     2B7 : D5                          SEP R5
(2)   88/     2B8 :                     ;------------------------------------------------------------------------------------------
(2)   89/     2B8 :                     
(2)   90/     2B8 :                     ; =========================================================================================
(2)   91/     2B8 :                     ; WaitForSafeUpdate -
(2)   92/     2B8 :                     ;               Check the 1861 video status and wait for DMA to complete before returning.
(2)   93/     2B8 :                     ;               When this function returns it is safe to make updates to the video.
(2)   94/     2B8 :                     ;               There will be time for about 8000 instruction cycles (at 2MHz) before the
(2)   95/     2B8 :                     ;               next DMA to occur.  All Get/Put video functions call this function before
(2)   96/     2B8 :                     ;               making any changes.  This logic is based on code found in Tom Pittman's, 
(2)   97/     2B8 :                     ;               Short Course In Programming, Chapter 7, Interrupts and DMA.
(2)   98/     2B8 :                     ;               
(2)   99/     2B8 :                     ;               Before DMA begins, EF1 is asserted for 28 instruction cycles, and before
(2)  100/     2B8 :                     ;               DMA ends EF1 is asserted for only 12 instruction cycles.  This code counts
(2)  101/     2B8 :                     ;               cycles while EF1 is asserted to determine when DMA has ended.
(2)  102/     2B8 :                     ;
(2)  103/     2B8 :                     ; Note: *REQUIRED* to guarantee safety before accessing video data. 
(2)  104/     2B8 :                     ;               Must call this function before calling any UNSAFE function.
(2)  105/     2B8 :                     ;
(2)  106/     2B8 :                     ; Internal:
(2)  107/     2B8 :                     ; RD            Pointer to video flag
(2)  108/     2B8 :                     ; =========================================================================================
(2)  109/     2B8 :                     
(2)  110/     2B8 : (MACRO)             WaitForSafeUpdate:      LOAD RD, VideoFlag      ; set pointer to video flag                                             
(2)  110/     2B8 : F8 07                       LDI  lo(VIDEOFLAG)
(2)  110/     2BA : AD                          PLO  RD
(2)  110/     2BB : F8 7F                       LDI  hi(VIDEOFLAG)
(2)  110/     2BD : BD                          PHI  RD     
(2)  111/     2BE : 0D                                          LDN  RD                 ; check video flag so we don't wait forever
(2)  112/     2BF : 32 CE                                       BZ   WFSU_Exit          ; for an EF1 signal that never occurs.
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 22 - 11/14/2020 15:50:57


(2)  113/     2C1 :                                                                     ; Any updates are fine when video is off
(2)  114/     2C1 :                                             
(2)  115/     2C1 :                     
(2)  116/     2C1 : 34 C1               WFSU_Check_DMA:         B1   WFSU_Check_DMA     ; wait for first EF1 siginal
(2)  117/     2C3 :                                     
(2)  118/     2C3 : F8 14               WFSU_Sync:              LDI  14H                ; 20 instruction cycles
(2)  119/     2C5 :                     
(2)  120/     2C5 : 3C C5               WFSU_New_EF1:           BN1  WFSU_New_EF1       ; wait for next EF1 signal to start count
(2)  121/     2C7 :                     
(2)  122/     2C7 : FF 02               WFSU_Count:             SMI  02                 ; count down by 2 and keep counting for 12
(2)  123/     2C9 : 34 C7                                       B1   WFSU_Count         ; (DMA end) or 28 (DMA begin) instructions
(2)  124/     2CB :                                             
(2)  125/     2CB : FE                                          SHL                     ; check sign bit to see if negative (20-28)
(2)  126/     2CC : 33 C3                                       BDF  WFSU_Sync          ; at DMA begin. DF = 1, means DMA begin
(2)  127/     2CE :                                                                     ; and we must wait for the DMA end
(2)  128/     2CE :                     
(2)  129/     2CE : (MACRO)             WFSU_Exit:              RETURN                  ; return now that DMA has ended
(2)  129/     2CE : D5                          SEP R5
(2)  130/     2CF :                     ;------------------------------------------------------------------------------------------                     
(2)  131/     2CF :                     
(2)  132/     2CF :                     ; =========================================================================================
(2)  133/     2CF :                     ; Create a pointer into a Video buffer at the location specified by Y location
(2)  134/     2CF :                     ;
(2)  135/     2CF :                     ; Note: *Internal* - Used to manipulator pointer into video buffer
(2)  136/     2CF :                     ;
(2)  137/     2CF :                     ; Parameters:
(2)  138/     2CF :                     ; RE.0          X coordinate of the character
(2)  139/     2CF :                     ; RE.1          Y coordinate of the character
(2)  140/     2CF :                     ;
(2)  141/     2CF :                     ; Internal:
(2)  142/     2CF :                     ; R7.0          Swap Pointer for video buffers
(2)  143/     2CF :                     ;
(2)  144/     2CF :                     ; Return:
(2)  145/     2CF :                     ; RF            Pointer to video buffer with Y Offset
(2)  146/     2CF :                     ; =========================================================================================
(2)  147/     2CF :                     
(2)  148/     2CF : =>TRUE              VideoOffsetY:           IF BackBuffer == "OFF"
(2)  149/     2CF : F8 7D                                               LDI  hi(DisplayBuffer)  ; prepare the pointer to the video buffer
(2)  150/     2D1 : BF                                                  PHI  RF
(2)  151/     2D2 : [148]                                       ENDIF
(2)  152/     2D2 :                     
(2)  153/     2D2 : =>FALSE                                     IF BackBuffer == "COPY"
(2)  154/     2D2 :                                                     LDI  hi(DoubleBuffer)   ; prepare the pointer to the back buffer
(2)  155/     2D2 :                                                     PHI  RF
(2)  156/     2D2 : [153]                                       ENDIF
(2)  157/     2D2 :                     
(2)  158/     2D2 : =>FALSE                                     IF BackBuffer == "SWAP"
(2)  159/     2D2 :                                                     GLO  R7                 ; prepare pointer to the current back buffer
(2)  160/     2D2 :                                                     PHI  RF
(2)  161/     2D2 : [158]                                       ENDIF                                   
(2)  162/     2D2 :                                             
(2)  163/     2D2 : 9E                                                  GHI  RE                 ; get the y position into video buffer                          
(2)  164/     2D3 :                                                     
(2)  165/     2D3 : =>FALSE                                     IF Resolution == "64x32"
(2)  166/     2D3 :                                                     ANI  1FH                ; between 0 - 31
(2)  167/     2D3 : [165]                                       ENDIF
(2)  168/     2D3 :                                                                                     
(2)  169/     2D3 : =>TRUE                                      IF Resolution == "64x64"
(2)  170/     2D3 : FA 3F                                               ANI  3FH                ; or 0 - 63
(2)  171/     2D5 : [169]                                       ENDIF
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 23 - 11/14/2020 15:50:57


(2)  172/     2D5 :                                             
(2)  173/     2D5 : =>FALSE                                     IF Resolution == "64x128"
(2)  174/     2D5 :                                                     ANI  7FH                ; or 0 - 127
(2)  175/     2D5 : [173]                                       ENDIF
(2)  176/     2D5 : FE                                                  SHL                     ; Convert Y value to position offset = (y * 8)
(2)  177/     2D6 : FE                                                  SHL                     ; check high bit of 64x128 count in df
(2)  178/     2D7 :                     
(2)  179/     2D7 : =>FALSE                                     IF Resolution == "64x128"
(2)  180/     2D7 :                                                     PLO  RF                 ; save RF low byte
(2)  181/     2D7 :                                                     BNF  VY_SkipHighInc     ; check high order bit of 64x128 count
(2)  182/     2D7 :                                                     GHI  RF                 ; get RF high byte
(2)  183/     2D7 :                                                     ADI  02H                ; df represents two's bit after shifting
(2)  184/     2D7 :                                                     PHI  RF                 ; update RF high byte
(2)  185/     2D7 :                     VY_SkipHighInc:                 GLO  RF                 ; restore RF low byte and continue shifting
(2)  186/     2D7 :                     
(2)  187/     2D7 : [179]                                       ENDIF                           
(2)  188/     2D7 : FE                                                  SHL
(2)  189/     2D8 : AF                                                  PLO  RF
(2)  190/     2D9 : 3B DF                                               BNF  VY_SkipLowInc
(2)  191/     2DB : 9F                                                  GHI  RF
(2)  192/     2DC : FC 01                                               ADI  01H
(2)  193/     2DE : BF                                                  PHI  RF
(2)  194/     2DF :                     
(2)  195/     2DF : (MACRO)             VY_SkipLowInc:                  RETURN
(2)  195/     2DF : D5                          SEP R5
(2)  196/     2E0 :                     ;------------------------------------------------------------------------------------------
(2)  197/     2E0 :                     
(2)  198/     2E0 :                     
(2)  199/     2E0 :                     ; =========================================================================================
(2)  200/     2E0 :                     ; Add the X byte offset to a pointer into a Video buffer
(2)  201/     2E0 :                     ;
(2)  202/     2E0 :                     ; Note: *Internal* - Used to manipulator pointer into video buffer
(2)  203/     2E0 :                     ;
(2)  204/     2E0 :                     ; Parameters:
(2)  205/     2E0 :                     ; RF            Pointer to video buffer with Y Offset
(2)  206/     2E0 :                     ; RE.0          X coordinate of the character
(2)  207/     2E0 :                     ; RE.1          Y coordinate of the character
(2)  208/     2E0 :                     ;
(2)  209/     2E0 :                     ; Return:
(2)  210/     2E0 :                     ; RF            Pointer to video buffer at X,Y byte Offset
(2)  211/     2E0 :                     ; RC.1          X Offset byte value
(2)  212/     2E0 :                     ; RC.0          X Offset bit value
(2)  213/     2E0 :                     ; =========================================================================================
(2)  214/     2E0 :                     
(2)  215/     2E0 : 8E                  VideoOffsetX:           GLO  RE         ; get the x bit position 
(2)  216/     2E1 : FA 07                                       ANI  07H        ; mask off all but lowest 3 bits
(2)  217/     2E3 : AC                                          PLO  RC         ; save bit value in RC.0
(2)  218/     2E4 :                                                     
(2)  219/     2E4 : 8E                                          GLO  RE         ; get the x byte position into video buffer
(2)  220/     2E5 : FA 3F                                       ANI  3FH        ; value 0 - 63
(2)  221/     2E7 : F6                                          SHR             ; Convert x value to position offset = (x / 8)
(2)  222/     2E8 : F6                                          SHR                     
(2)  223/     2E9 : F6                                          SHR
(2)  224/     2EA : BC                                          PHI  RC         ; save byte value in RC.1
(2)  225/     2EB :                                                                     
(2)  226/     2EB :                     
(2)  227/     2EB : 73                                          STXD            ; byte position offset in M(X)
(2)  228/     2EC : 60                                          IRX
(2)  229/     2ED :                                                     
(2)  230/     2ED : 8F                                          GLO  RF         ; advance the pointer coordinate by byte offset                         
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 24 - 11/14/2020 15:50:57


(2)  231/     2EE : F4                                          ADD             ; add the offset to pointer                                     
(2)  232/     2EF : AF                                          PLO  RF         ; save lower byte
(2)  233/     2F0 :                                             
(2)  234/     2F0 : 9F                                          GHI  RF         ; update high byte if needed                    
(2)  235/     2F1 : 7C 00                                       ADCI 00H        ; Add carry into high byte and save
(2)  236/     2F3 : BF                                          PHI  RF
(2)  237/     2F4 :                                                     
(2)  238/     2F4 : (MACRO)                                     RETURN
(2)  238/     2F4 : D5                          SEP R5
(2)  239/     2F5 :                     ;------------------------------------------------------------------------------------------
(2)  240/     2F5 :                     
(2)  241/     2F5 :                     ; =========================================================================================
(2)  242/     2F5 :                     ; SetVideoFlag - Set the video flag to false or true
(2)  243/     2F5 :                     ;
(2)  244/     2F5 :                     ; Note: *Internal* - Use VideoOn and VideOff to set or clear the video flag
(2)  245/     2F5 :                     ;
(2)  246/     2F5 :                     ; Parameters:
(2)  247/     2F5 :                     ; RF.0          Value for flag, zero for false, non-zero for true
(2)  248/     2F5 :                     ; Internal:
(2)  249/     2F5 :                     ; RD            Pointer to video flag
(2)  250/     2F5 :                     ; =========================================================================================
(2)  251/     2F5 : (MACRO)             SetVideoFlag:           LOAD RD, VideoFlag      ; set pointer to video flag                                                     
(2)  251/     2F5 : F8 07                       LDI  lo(VIDEOFLAG)
(2)  251/     2F7 : AD                          PLO  RD
(2)  251/     2F8 : F8 7F                       LDI  hi(VIDEOFLAG)
(2)  251/     2FA : BD                          PHI  RD     
(2)  252/     2FB : 8F                                          GLO  RF                 ; get the value for the flag
(2)  253/     2FC : 5D                                          STR  RD                 ; store the flag
(2)  254/     2FD :                                             
(2)  255/     2FD : (MACRO)                                     RETURN
(2)  255/     2FD : D5                          SEP R5
(2)  256/     2FE :                     ;------------------------------------------------------------------------------------------                     
(2)  257/     2FE :                     
(2)  258/     2FE :                     ; =========================================================================================
(2)  259/     2FE :                     ; Clear a line of text on the video console (6 rows of pixels at 8 bytes per row) along
(2)  260/     2FE :                     ; with the 2 rows of the next row of text.
(2)  261/     2FE :                     ;
(2)  262/     2FE :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
(2)  263/     2FE :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  264/     2FE :                     ;
(2)  265/     2FE :                     ; Parameters:
(2)  266/     2FE :                     ; RE.0          X coordinate of the character
(2)  267/     2FE :                     ; RE.1          Y coordinate of the character
(2)  268/     2FE :                     ;
(2)  269/     2FE :                     ; Internal:
(2)  270/     2FE :                     ; RF            Pointer to video buffer
(2)  271/     2FE :                     ; RD            Counter
(2)  272/     2FE :                     ; R7.0          Swap Pointer for video buffers
(2)  273/     2FE :                     ; =========================================================================================
(2)  274/     2FE :                     
(2)  275/     2FE : (MACRO)             BlankLine:              CALL VideoOffsetY
(2)  275/     2FE : D4                          SEP R4
(2)  275/     2FF : 02 CF                       dw  VIDEOOFFSETY
(2)  276/     301 :                                                                                                     
(2)  277/     301 :                                                             
(2)  278/     301 : F8 00                                       LDI  00H        ; load byte counter
(2)  279/     303 : BD                                          PHI  RD
(2)  280/     304 : AD                                          PLO  RD
(2)  281/     305 :                     
(2)  282/     305 : F8 00               BL_Loop:                LDI  00H
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 25 - 11/14/2020 15:50:57


(2)  283/     307 : 5F                                          STR  RF
(2)  284/     308 : 1F                                          INC  RF
(2)  285/     309 : 1D                                          INC  RD
(2)  286/     30A :                                                             
(2)  287/     30A : 8D                                          GLO  RD
(2)  288/     30B :                                             
(2)  289/     30B : FD 40                                       SDI  40H        ;do 64 times (6 rows of pixels x 8 bytes per row                                        
(2)  290/     30D :                                                             ; + 2 rows to overwrite existing text on line below.)                           
(2)  291/     30D : CA 03 05                                    LBNZ BL_Loop    
(2)  292/     310 :                                                             
(2)  293/     310 : (MACRO)                                     RETURN
(2)  293/     310 : D5                          SEP R5
(2)  294/     311 :                     ;------------------------------------------------------------------------------------------
(2)  295/     311 :                     
(2)  296/     311 :                     ; =========================================================================================
(2)  297/     311 :                     ; Advance cursor to next tab stop: 08H, 10H, 18H, 20H, 28H, 30H, 38H, 00H (NextLine)
(2)  298/     311 :                     ;
(2)  299/     311 :                     ; Note: Safe - This function does not access video data
(2)  300/     311 :                     ;
(2)  301/     311 :                     ; Parameters:
(2)  302/     311 :                     ; RE.0          X coordinate of the character
(2)  303/     311 :                     ; RE.1          Y coordinate of the character
(2)  304/     311 :                     ;
(2)  305/     311 :                     ;
(2)  306/     311 :                     ; Return:
(2)  307/     311 :                     ; RE.0          Updated X coordinate
(2)  308/     311 :                     ; RE.1          Updated Y coordinate
(2)  309/     311 :                     ; =========================================================================================
(2)  310/     311 :                     
(2)  311/     311 : 8E                  TabCursor:              GLO  RE                 ; get cursorX value
(2)  312/     312 : FC 08                                       ADI  08H                ; advance 8 pixels, 2 avg char widths
(2)  313/     314 : FA 78                                       ANI  78H                ; mask off lower 3 bits (truncate to 8)
(2)  314/     316 : AE                                          PLO  RE                 ; set the x cursor to begining of line (zero) 
(2)  315/     317 :                     
(2)  316/     317 : FD 38                                       SDI  38H                ; check to see if we went past last tab stop
(2)  317/     319 : 33 1E                                       BGE  TAB_Exit           ; If not, we're done
(2)  318/     31B :                                             
(2)  319/     31B : (MACRO)                                     CALL NextLine           ; If we went over go to next line
(2)  319/     31B : D4                          SEP R4
(2)  319/     31C : 03 3C                       dw  NEXTLINE
(2)  320/     31E :                                             
(2)  321/     31E :                                                                                     
(2)  322/     31E : (MACRO)             TAB_Exit:               RETURN
(2)  322/     31E : D5                          SEP R5
(2)  323/     31F :                     ;------------------------------------------------------------------------------------------
(2)  324/     31F :                     ; =========================================================================================
(2)  325/     31F :                     ; Move cursor back one position and delete the character
(2)  326/     31F :                     ;
(2)  327/     31F :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
(2)  328/     31F :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  329/     31F :                     
(2)  330/     31F :                     ;
(2)  331/     31F :                     ; Parameters:
(2)  332/     31F :                     ; RE.0          X coordinate of the character
(2)  333/     31F :                     ; RE.1          Y coordinate of the character
(2)  334/     31F :                     ; 
(2)  335/     31F :                     ; Internals:
(2)  336/     31F :                     ; RF.0          Width of average character to back up
(2)  337/     31F :                     ;
(2)  338/     31F :                     ; Return:
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 26 - 11/14/2020 15:50:57


(2)  339/     31F :                     ; RE.0          Updated X coordinate
(2)  340/     31F :                     ; RE.1          Updated Y coordinate
(2)  341/     31F :                     ; =========================================================================================
(2)  342/     31F :                     
(2)  343/     31F : F8 04               Backspace:              LDI  04H                ; average charcter width = 4 pixels
(2)  344/     321 : AF                                          PLO  RF                 ; RD.0 has width to back pu
(2)  345/     322 : (MACRO)                                     CALL LeftCursor         ; Move cursor back one character                
(2)  345/     322 : D4                          SEP R4
(2)  345/     323 : 03 8F                       dw  LEFTCURSOR
(2)  346/     325 :                                             
(2)  347/     325 : (MACRO)                                     CALL BlankCharacter     ; erase the previous character  
(2)  347/     325 : D4                          SEP R4
(2)  347/     326 : 03 5A                       dw  BLANKCHARACTER
(2)  348/     328 :                                                                                     
(2)  349/     328 : (MACRO)                                     RETURN
(2)  349/     328 : D5                          SEP R5
(2)  350/     329 :                     ;------------------------------------------------------------------------------------------
(2)  351/     329 :                     
(2)  352/     329 :                     
(2)  353/     329 :                     ; =========================================================================================
(2)  354/     329 :                     ; Create mask for blanking character bits in video buffer
(2)  355/     329 :                     ;
(2)  356/     329 :                     ; Note: *Internal* - Used for removing character pixels
(2)  357/     329 :                     ;
(2)  358/     329 :                     ; Parameters:
(2)  359/     329 :                     ; RE.0          X coordinate of the character
(2)  360/     329 :                     ; RE.1          Y coordinate of the character
(2)  361/     329 :                     ; RC.0          X Offset bit value
(2)  362/     329 :                     ; RC.1          X Offset byte value
(2)  363/     329 :                     ;
(2)  364/     329 :                     ; Internals:
(2)  365/     329 :                     ; RD.0          Counter for calculating Mask
(2)  366/     329 :                     ;
(2)  367/     329 :                     ; Returns:
(2)  368/     329 :                     ; RD.1          Mask for video bit values X byte
(2)  369/     329 :                     ; =========================================================================================
(2)  370/     329 : F8 FF               CreateMask:             LDI  00FFH              ; load bit mask
(2)  371/     32B : BD                                          PHI  RD         
(2)  372/     32C : 8C                                          GLO  RC                 ; put the X offset bit value in counter
(2)  373/     32D : AD                                          PLO  RD                  
(2)  374/     32E :                                             
(2)  375/     32E : 32 37               CM_Test:                BZ   CM_Done            ; keep going to counter exhausted
(2)  376/     330 : 9D                                          GHI  RD                 ; get the mask byte
(2)  377/     331 : F6                                          SHR                     ; shift once for each bit offset
(2)  378/     332 : BD                                          PHI  RD                 ; save mask value
(2)  379/     333 : 2D                                          DEC  RD                 ; decrement counter
(2)  380/     334 : 8D                                          GLO  RD                 ; test byte for zero
(2)  381/     335 : 30 2E                                       BR   CM_Test
(2)  382/     337 :                                             
(2)  383/     337 : 9D                  CM_Done:                GHI  RD                 ; get mask value
(2)  384/     338 : FB FF                                       XRI  00FFH              ; invert all the bits for ANDing
(2)  385/     33A : BD                                          PHI  RD                 ; put bit mask back in RD.1
(2)  386/     33B :                     
(2)  387/     33B :                     
(2)  388/     33B : (MACRO)                                     RETURN
(2)  388/     33B : D5                          SEP R5
(2)  389/     33C :                     ;------------------------------------------------------------------------------------------
(2)  390/     33C :                     
(2)  391/     33C :                     
(2)  392/     33C :                     ; =========================================================================================
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 27 - 11/14/2020 15:50:57


(2)  393/     33C :                     ; Advance cursor to begining of the next line. 
(2)  394/     33C :                     ;
(2)  395/     33C :                     ; Note: Safe - This function does not access video data
(2)  396/     33C :                     ;
(2)  397/     33C :                     ; Parameters:
(2)  398/     33C :                     ; RE.0          X coordinate of the character
(2)  399/     33C :                     ; RE.1          Y coordinate of the character
(2)  400/     33C :                     ;
(2)  401/     33C :                     ;
(2)  402/     33C :                     ; Return:
(2)  403/     33C :                     ; RE.0          Updated X coordinate
(2)  404/     33C :                     ; RE.1          Updated Y coordinate
(2)  405/     33C :                     ; =========================================================================================
(2)  406/     33C :                     
(2)  407/     33C : F8 00               NextLine:               LDI  00H                ; load zero and save as cursorX
(2)  408/     33E : AE                                          PLO  RE                 ; set the x cursor to begining of line (zero) 
(2)  409/     33F :                     
(2)  410/     33F : 9E                                          GHI  RE                 ; advance y cursor to point to next line                                                                        
(2)  411/     340 : FC 06                                       ADI  06H                ; each line is 6 pixels high
(2)  412/     342 : BE                                          PHI  RE                 ; update cursorY 
(2)  413/     343 :                     
(2)  414/     343 : =>FALSE                             IF Resolution == "64x128"       
(2)  415/     343 :                                             SDI  78H                ; check to see if we are past the end           
(2)  416/     343 :                                             BGE NL_Exit             ; DF = 1 means haven't gone past 120 y pixels                                                   
(2)  417/     343 :                                             
(2)  418/     343 :                                             LDI  04H                ; go back to top line
(2)  419/     343 :                                             PHI  RE                 ; update cursorY                
(2)  420/     343 : [414]                               ENDIF
(2)  421/     343 :                                             
(2)  422/     343 : =>TRUE                              IF Resolution == "64x64"        
(2)  423/     343 : FD 3C                                       SDI  3CH                ; check to see if we are past the end
(2)  424/     345 : 33 4A                                       BGE NL_Exit             ; DF = 1 means haven't gone past 60 y pixels                            
(2)  425/     347 :                                             
(2)  426/     347 : F8 02                                       LDI  02H                ; go back to top line
(2)  427/     349 : BE                                          PHI  RE                 ; update cursorY                
(2)  428/     34A : [422]                               ENDIF
(2)  429/     34A :                                             
(2)  430/     34A : =>FALSE                             IF Resolution == "64x32"        
(2)  431/     34A :                                             SDI  1EH                ; check to see if we are past the end
(2)  432/     34A :                                             BGE NL_Exit             ; DF = 1 means haven't gone past 30 y pixels                            
(2)  433/     34A :                                             
(2)  434/     34A :                                             LDI  01H                ; go back to top line
(2)  435/     34A :                                             PHI  RE                 ; update cursorY
(2)  436/     34A : [430]                               ENDIF
(2)  437/     34A :                                                                                     
(2)  438/     34A : (MACRO)             NL_Exit:                RETURN
(2)  438/     34A : D5                          SEP R5
(2)  439/     34B :                     ;------------------------------------------------------------------------------------------
(2)  440/     34B :                     
(2)  441/     34B :                     ; =========================================================================================
(2)  442/     34B :                     ; Advance cursor down to next line without changing x location
(2)  443/     34B :                     ;
(2)  444/     34B :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
(2)  445/     34B :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  446/     34B :                     ;
(2)  447/     34B :                     ; Parameters:
(2)  448/     34B :                     ; RE.0          X coordinate of the character
(2)  449/     34B :                     ; RE.1          Y coordinate of the character
(2)  450/     34B :                     ;
(2)  451/     34B :                     ;
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 28 - 11/14/2020 15:50:57


(2)  452/     34B :                     ; Return:
(2)  453/     34B :                     ; RE.0          Updated X coordinate
(2)  454/     34B :                     ; RE.1          Updated Y coordinate
(2)  455/     34B :                     ; =========================================================================================
(2)  456/     34B :                     
(2)  457/     34B : 9E                  DownCursor:             GHI  RE                 ; move y by 6 pixels
(2)  458/     34C : FC 06                                       ADI  06H
(2)  459/     34E : BE                                          PHI  RE                 ; save y
(2)  460/     34F :                                             
(2)  461/     34F : =>FALSE                             IF Resolution == "64x128"                                                                                       
(2)  462/     34F :                                             SDI  78H                ; check y value to see if we went past 120
(2)  463/     34F :                                             BGE  DC_Blank           ; if not, erase the next line                   
(2)  464/     34F :                     
(2)  465/     34F :                                             LDI  04H                ; if so, move back to first line at top of console
(2)  466/     34F :                                             PHI  RE                 ; save y
(2)  467/     34F : [461]                               ENDIF
(2)  468/     34F :                                     
(2)  469/     34F : =>TRUE                              IF Resolution == "64x64"                                                                                        
(2)  470/     34F : FD 3C                                       SDI  3CH                ; check y value to see if we went past 60
(2)  471/     351 : 33 56                                       BGE  DC_Blank           ; if not, erase the next line
(2)  472/     353 :                                             
(2)  473/     353 : F8 02                                       LDI  02H                ; if so, move back to first line at top of console
(2)  474/     355 : BE                                          PHI  RE                 ; save y
(2)  475/     356 : [469]                               ENDIF
(2)  476/     356 :                                             
(2)  477/     356 : =>FALSE                             IF Resolution == "64x32"        
(2)  478/     356 :                                             SDI  1EH                ; check y value to see if we went past 30
(2)  479/     356 :                                             BGE  DC_Blank           ; if not, erase the next line
(2)  480/     356 :                                             
(2)  481/     356 :                                             LDI  01H                ; if so, move back to first line at top of console
(2)  482/     356 :                                             PHI  RE                 ; save y        
(2)  483/     356 : [477]                               ENDIF
(2)  484/     356 :                                             
(2)  485/     356 : (MACRO)             DC_Blank:               CALL BlankLine          ; erase existing text
(2)  485/     356 : D4                          SEP R4
(2)  485/     357 : 02 FE                       dw  BLANKLINE
(2)  486/     359 :                                             
(2)  487/     359 :                                                                                     
(2)  488/     359 : (MACRO)                                     RETURN
(2)  488/     359 : D5                          SEP R5
(2)  489/     35A :                     ;------------------------------------------------------------------------------------------
(2)  490/     35A :                     
(2)  491/     35A :                     ; =========================================================================================
(2)  492/     35A :                     ; Clear character pixels from the current cursor location
(2)  493/     35A :                     ;
(2)  494/     35A :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
(2)  495/     35A :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  496/     35A :                     ;
(2)  497/     35A :                     ; Parameters:
(2)  498/     35A :                     ; RE.0          X coordinate of the character
(2)  499/     35A :                     ; RE.1          Y coordinate of the character
(2)  500/     35A :                     ;
(2)  501/     35A :                     ; Internal:
(2)  502/     35A :                     ; RF            Pointer to video buffer
(2)  503/     35A :                     ; RD.1          Mask for video bit values X byte
(2)  504/     35A :                     ; RD.0          Counter
(2)  505/     35A :                     ; RC.0          X Offset bit value
(2)  506/     35A :                     ; RC.1          X Offset byte value
(2)  507/     35A :                     ; =========================================================================================
(2)  508/     35A :                     
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 29 - 11/14/2020 15:50:57


(2)  509/     35A : (MACRO)             BlankCharacter:         CALL VideoOffsetY       ; set pointer to video at y location
(2)  509/     35A : D4                          SEP R4
(2)  509/     35B : 02 CF                       dw  VIDEOOFFSETY
(2)  510/     35D : (MACRO)                                     CALL VideoOffsetX       ; set pointer to video at x,y location
(2)  510/     35D : D4                          SEP R4
(2)  510/     35E : 02 E0                       dw  VIDEOOFFSETX
(2)  511/     360 :                     
(2)  512/     360 : 8E                                          GLO  RE                 ; check x location
(2)  513/     361 : 3A 68                                       BNZ  BCH_GetMask        ; if inside line, calculate masks
(2)  514/     363 :                                             
(2)  515/     363 : (MACRO)                                     CALL BlankLine          ; if we are the begining, just clear the line
(2)  515/     363 : D4                          SEP R4
(2)  515/     364 : 02 FE                       dw  BLANKLINE
(2)  516/     366 : 30 8E                                       BR   BCH_Done                   
(2)  517/     368 :                                                                     
(2)  518/     368 : (MACRO)             BCH_GetMask:            CALL CreateMask         ; get the mask for video bits
(2)  518/     368 : D4                          SEP R4
(2)  518/     369 : 03 29                       dw  CREATEMASK
(2)  519/     36B :                     
(2)  520/     36B : F8 00                                       LDI  00H                ; initialize counter 
(2)  521/     36D : AD                                          PLO  RD                 
(2)  522/     36E :                                             
(2)  523/     36E :                     
(2)  524/     36E : 9D                  BCH_Blank:              GHI  RD                 ; get mask and put at M(X)
(2)  525/     36F : 73                                          STXD
(2)  526/     370 : 60                                          IRX
(2)  527/     371 :                                             
(2)  528/     371 : 0F                                          LDN  RF                 ; load video byte
(2)  529/     372 : F2                                          AND                     ; and with mask                 
(2)  530/     373 : 5F                                          STR  RF                 ; put it back in memory
(2)  531/     374 :                                             
(2)  532/     374 : 9C                                          GHI  RC                 ; get the byte offset value
(2)  533/     375 : FD 07                                       SDI  07H                ; check for last byte
(2)  534/     377 : 32 7E                                       BZ   BCH_LastByte       ; don't blank next byte after last byte
(2)  535/     379 :                                             
(2)  536/     379 : F8 00                                       LDI  00H                ; blank out next byte after byte 0 to 6
(2)  537/     37B : 1F                                          INC  RF                 ; set video pointer to next byte
(2)  538/     37C : 5F                                          STR  RF                 ; blank out any remaining pixels
(2)  539/     37D : 2F                                          DEC  RF                 ; set video ptr back to x byte
(2)  540/     37E :                                             
(2)  541/     37E : 1D                  BCH_LastByte:           INC  RD                 ; increment counter
(2)  542/     37F : 8D                                          GLO  RD                 ; check if done 5 times
(2)  543/     380 : FD 05                                       SDI  05H                
(2)  544/     382 : 32 8E                                       BZ   BCH_Done           
(2)  545/     384 :                                             
(2)  546/     384 : 8F                                          GLO  RF                 ; Adjust pointer to next line of character
(2)  547/     385 : FC 08                                       ADI  08H                ; each line is 8 bytes 
(2)  548/     387 : AF                                          PLO  RF                 ; save low byte and adjust hi byte with carry
(2)  549/     388 :                                             
(2)  550/     388 : 9F                                          GHI  RF
(2)  551/     389 : 7C 00                                       ADCI 00H                
(2)  552/     38B : BF                                          PHI  RF                 ; video pointer now points to next line of character
(2)  553/     38C : 30 6E                                       BR   BCH_Blank          ; do next line
(2)  554/     38E :                                             
(2)  555/     38E : (MACRO)             BCH_Done:               RETURN
(2)  555/     38E : D5                          SEP R5
(2)  556/     38F :                     ;------------------------------------------------------------------------------------------
(2)  557/     38F :                     
(2)  558/     38F :                     
(2)  559/     38F :                     ; =========================================================================================
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 30 - 11/14/2020 15:50:57


(2)  560/     38F :                     ; Move cursor backwards a number of pixel widths
(2)  561/     38F :                     ;
(2)  562/     38F :                     ; Note: Safe - This function does not access video data
(2)  563/     38F :                     ;
(2)  564/     38F :                     ; Parameters:
(2)  565/     38F :                     ; RF.0          Width to back up cursor
(2)  566/     38F :                     ; RE.0          X coordinate of the character
(2)  567/     38F :                     ; RE.1          Y coordinate of the character
(2)  568/     38F :                     ;
(2)  569/     38F :                     ;
(2)  570/     38F :                     ; Return:
(2)  571/     38F :                     ; RE.0          Updated X coordinate
(2)  572/     38F :                     ; RE.1          Updated Y coordinate
(2)  573/     38F :                     ; =========================================================================================
(2)  574/     38F :                     
(2)  575/     38F : 8E                  LeftCursor:             GLO  RE                 ; 
(2)  576/     390 : 32 9E                                       BZ   LC_PreviousLine    ; if begining of line, go back one line
(2)  577/     392 :                                             
(2)  578/     392 : 73                                          STXD                    ; store x location it in M(X)
(2)  579/     393 : 60                                          IRX
(2)  580/     394 :                                             
(2)  581/     394 : 8F                                          GLO  RF                 ; get the pixel width
(2)  582/     395 :                                             
(2)  583/     395 : F5                                          SD                      ; move x back RD.0 pixels
(2)  584/     396 : AE                                          PLO  RE                 ; save x                                                                                
(2)  585/     397 : 33 B3                                       BGE  LC_Exit            ; if positive or zero, we are done
(2)  586/     399 :                                             
(2)  587/     399 : F8 00                                       LDI  00H                ; don't back up before begining of line
(2)  588/     39B : AE                                          PLO  RE
(2)  589/     39C : 30 B3                                       BR   LC_Exit            
(2)  590/     39E :                                             
(2)  591/     39E : 9E                  LC_PreviousLine:        GHI  RE
(2)  592/     39F : FF 06                                       SMI  06H                ; back up one line
(2)  593/     3A1 : BE                                          PHI  RE
(2)  594/     3A2 : 3B AD                                       BL   LC_Home            ; but don't go beyond home
(2)  595/     3A4 :                                             
(2)  596/     3A4 : F8 40                                       LDI  40H                ; set M(X) to end of line
(2)  597/     3A6 : 73                                          STXD                    ; store eol in M(X)
(2)  598/     3A7 : 60                                          IRX
(2)  599/     3A8 :                                             
(2)  600/     3A8 : 8F                                          GLO  RF                 ; get the pixel width
(2)  601/     3A9 : F5                                          SD                      ; back up from eol                      
(2)  602/     3AA : AE                                          PLO  RE         
(2)  603/     3AB : 30 B3                                       BR   LC_Exit
(2)  604/     3AD :                                             
(2)  605/     3AD : =>FALSE             LC_Home:        IF Resolution == "64x128"
(2)  606/     3AD :                                             LDI  04H                ; set y to first line
(2)  607/     3AD :                                             PHI  RE
(2)  608/     3AD : [605]                               ENDIF
(2)  609/     3AD :                                     
(2)  610/     3AD : =>TRUE                              IF Resolution == "64x64"
(2)  611/     3AD : F8 02                                       LDI  02H                ; set y to first line
(2)  612/     3AF : BE                                          PHI  RE
(2)  613/     3B0 : [610]                               ENDIF
(2)  614/     3B0 :                                     
(2)  615/     3B0 : =>FALSE                             IF Resolution == "64x32"        
(2)  616/     3B0 :                                             LDI  01H                ; set y to first line
(2)  617/     3B0 :                                             PHI  RE
(2)  618/     3B0 : [615]                               ENDIF
(2)  619/     3B0 : F8 00                                       LDI  00H                ; set x to beginning
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 31 - 11/14/2020 15:50:57


(2)  620/     3B2 : AE                                          PLO  RE
(2)  621/     3B3 :                     
(2)  622/     3B3 : (MACRO)             LC_Exit:                RETURN
(2)  622/     3B3 : D5                          SEP R5
(2)  623/     3B4 :                     ;------------------------------------------------------------------------------------------
(2)  624/     3B4 :                     
(2)  625/     3B4 :                     
(2)  626/     3B4 :                     ; =========================================================================================
(2)  627/     3B4 :                     ; Move cursor forwards a number of pixel widths
(2)  628/     3B4 :                     ;
(2)  629/     3B4 :                     ; Note: Safe - This function does not access video data
(2)  630/     3B4 :                     ;
(2)  631/     3B4 :                     ; Parameters:
(2)  632/     3B4 :                     ; RF.0          Width to advance cursor
(2)  633/     3B4 :                     ; RE.0          X coordinate of the character
(2)  634/     3B4 :                     ; RE.1          Y coordinate of the character
(2)  635/     3B4 :                     ;
(2)  636/     3B4 :                     ;
(2)  637/     3B4 :                     ; Return:
(2)  638/     3B4 :                     ; RE.0          Updated X coordinate
(2)  639/     3B4 :                     ; RE.1          Updated Y coordinate
(2)  640/     3B4 :                     ; =========================================================================================
(2)  641/     3B4 :                     
(2)  642/     3B4 : 8F                  RightCursor:            GLO  RF                 ; advance the x coordinate by the
(2)  643/     3B5 : 73                                          STXD                    ; width of the character + 1
(2)  644/     3B6 : 60                                          IRX                     ; store width in M(X)
(2)  645/     3B7 :                                             
(2)  646/     3B7 : 8E                                          GLO  RE
(2)  647/     3B8 : F4                                          ADD
(2)  648/     3B9 : FC 01                                       ADI  01H
(2)  649/     3BB : AE                                          PLO  RE
(2)  650/     3BC :                                                             
(2)  651/     3BC : FD 3C                                       SDI  3CH                ; check x value to see if we went past 60
(2)  652/     3BE : 33 CE                                       BGE  RC_Exit
(2)  653/     3C0 :                                                             
(2)  654/     3C0 : F8 00                                       LDI  00H                ; set x for beginning of next line and adjust y
(2)  655/     3C2 : AE                                          PLO  RE
(2)  656/     3C3 :                                                                                     
(2)  657/     3C3 : 9E                                          GHI  RE                 ; move y by 6 pixels
(2)  658/     3C4 : FC 06                                       ADI  06H
(2)  659/     3C6 : BE                                          PHI  RE
(2)  660/     3C7 :                     
(2)  661/     3C7 : =>FALSE                             IF Resolution == "64x128"               
(2)  662/     3C7 :                                             SDI  78H                ; check y value to see if we went past 120
(2)  663/     3C7 :                                             BGE  RC_Exit
(2)  664/     3C7 :                                                                     
(2)  665/     3C7 :                                             LDI  04H                ; if so move back to first line at top of console
(2)  666/     3C7 :                                             PHI  RE 
(2)  667/     3C7 : [661]                               ENDIF                                   
(2)  668/     3C7 :                                     
(2)  669/     3C7 : =>TRUE                              IF Resolution == "64x64"                
(2)  670/     3C7 : FD 3C                                       SDI  3CH                ; check y value to see if we went past 60
(2)  671/     3C9 : 33 CE                                       BGE  RC_Exit
(2)  672/     3CB :                                             
(2)  673/     3CB : F8 02                                       LDI  02H                ; if so move back to first line at top of console
(2)  674/     3CD : BE                                          PHI  RE 
(2)  675/     3CE : [669]                               ENDIF
(2)  676/     3CE :                                     
(2)  677/     3CE : =>FALSE                             IF Resolution == "64x32"        
(2)  678/     3CE :                                             SDI  1EH                ; check y value to see if we went past 30
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 32 - 11/14/2020 15:50:57


(2)  679/     3CE :                                             BGE  RC_Exit
(2)  680/     3CE :                                                                     
(2)  681/     3CE :                                             LDI  01H                ; if so move back to first line at top of console
(2)  682/     3CE :                                             PHI  RE 
(2)  683/     3CE : [677]                               ENDIF
(2)  684/     3CE :                     
(2)  685/     3CE : (MACRO)             RC_Exit:                RETURN
(2)  685/     3CE : D5                          SEP R5
(2)  686/     3CF :                     ;------------------------------------------------------------------------------------------
(2)  687/     3CF :                     
(2)  688/     3CF :                     ; =========================================================================================
(2)  689/     3CF :                     ; Move cursor back one pixel position and clear the column
(2)  690/     3CF :                     ;
(2)  691/     3CF :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
(2)  692/     3CF :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  693/     3CF :                     ;
(2)  694/     3CF :                     ; Parameters:
(2)  695/     3CF :                     ; RE.0          X coordinate of the character
(2)  696/     3CF :                     ; RE.1          Y coordinate of the character
(2)  697/     3CF :                     ; 
(2)  698/     3CF :                     ; Internals:
(2)  699/     3CF :                     ; RF.0          Width of to back up
(2)  700/     3CF :                     ;
(2)  701/     3CF :                     ; Return:
(2)  702/     3CF :                     ; RE.0          Updated X coordinate
(2)  703/     3CF :                     ; RE.1          Updated Y coordinate
(2)  704/     3CF :                     ; =========================================================================================
(2)  705/     3CF :                     
(2)  706/     3CF : F8 01               Rubout:                 LDI  01H                ; rubout one column of pixels
(2)  707/     3D1 : AF                                          PLO  RF                 ; pixel width to back up
(2)  708/     3D2 : (MACRO)                                     CALL LeftCursor         ; Move cursor back one character                
(2)  708/     3D2 : D4                          SEP R4
(2)  708/     3D3 : 03 8F                       dw  LEFTCURSOR
(2)  709/     3D5 :                                             
(2)  710/     3D5 : (MACRO)                                     CALL BlankCharacter     ; erase the previous pixel column       
(2)  710/     3D5 : D4                          SEP R4
(2)  710/     3D6 : 03 5A                       dw  BLANKCHARACTER
(2)  711/     3D8 :                                                                                     
(2)  712/     3D8 : (MACRO)                                     RETURN
(2)  712/     3D8 : D5                          SEP R5
(2)  713/     3D9 :                     ;------------------------------------------------------------------------------------------
(2)  714/     3D9 :                     
(2)  715/     3D9 :                     ; =========================================================================================
(2)  716/     3D9 :                     ; Move cursor forward one pixel position
(2)  717/     3D9 :                     ;
(2)  718/     3D9 :                     ; Note: Safe - This function does not access video data
(2)  719/     3D9 :                     ;
(2)  720/     3D9 :                     ; Parameters:
(2)  721/     3D9 :                     ; RE.0          X coordinate of the character
(2)  722/     3D9 :                     ; RE.1          Y coordinate of the character
(2)  723/     3D9 :                     ; 
(2)  724/     3D9 :                     ; Internals:
(2)  725/     3D9 :                     ; RF.0          Width of character (zero)
(2)  726/     3D9 :                     ;
(2)  727/     3D9 :                     ; Return:
(2)  728/     3D9 :                     ; RE.0          Updated X coordinate
(2)  729/     3D9 :                     ; RE.1          Updated Y coordinate
(2)  730/     3D9 :                     ; =========================================================================================
(2)  731/     3D9 : F8 00               UnitSeparator:          LDI  00H                ; put zero as character width
(2)  732/     3DB : AF                                          PLO  RF                 
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 33 - 11/14/2020 15:50:57


(2)  733/     3DC :                                             
(2)  734/     3DC : (MACRO)                                     CALL RightCursor        ; advance cursor 0+1 pixel column
(2)  734/     3DC : D4                          SEP R4
(2)  734/     3DD : 03 B4                       dw  RIGHTCURSOR
(2)  735/     3DF :                                             
(2)  736/     3DF : (MACRO)                                     RETURN
(2)  736/     3DF : D5                          SEP R5
(2)  737/     3E0 :                     ; =========================================================================================
(2)  738/     3E0 :                     ; Clear line and position cursror at the begining of the current line. 
(2)  739/     3E0 :                     ;
(2)  740/     3E0 :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
(2)  741/     3E0 :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  742/     3E0 :                     ;
(2)  743/     3E0 :                     ; Parameters:
(2)  744/     3E0 :                     ; RE.0          X coordinate of the character
(2)  745/     3E0 :                     ; RE.1          Y coordinate of the character
(2)  746/     3E0 :                     ;
(2)  747/     3E0 :                     ;
(2)  748/     3E0 :                     ; Return:
(2)  749/     3E0 :                     ; RE.0          Updated X coordinate
(2)  750/     3E0 :                     ; RE.1          Updated Y coordinate
(2)  751/     3E0 :                     ; =========================================================================================
(2)  752/     3E0 :                     
(2)  753/     3E0 : F8 00               CancelLine:             LDI  00H                ; load zero and save as cursorX
(2)  754/     3E2 : AE                                          PLO  RE                 ; set the x cursor to begining of line (zero) 
(2)  755/     3E3 :                     
(2)  756/     3E3 : (MACRO)                                     CALL BlankLine          ; clear the line
(2)  756/     3E3 : D4                          SEP R4
(2)  756/     3E4 : 02 FE                       dw  BLANKLINE
(2)  757/     3E6 :                                             
(2)  758/     3E6 : (MACRO)                                     RETURN
(2)  758/     3E6 : D5                          SEP R5
(2)  759/     3E7 :                     ;------------------------------------------------------------------------------------------
(2)  760/     3E7 :                     
(2)  761/     3E7 :                     ; =========================================================================================
(2)  762/     3E7 :                     ; ClearScreen - Blank the video screen and home the cursor.
(2)  763/     3E7 :                     ;
(2)  764/     3E7 :                     ; Note: Safe - This function checks the video status before accessing video data
(2)  765/     3E7 :                     ;
(2)  766/     3E7 :                     ; Internal:
(2)  767/     3E7 :                     ; RF.1          zero value to fill screen
(2)  768/     3E7 :                     ; RE.0          X coordinate of the character
(2)  769/     3E7 :                     ; RE.1          Y coordinate of the character
(2)  770/     3E7 :                     ; =========================================================================================
(2)  771/     3E7 :                     
(2)  772/     3E7 : (MACRO)             ClearScreen:            CALL WaitForSafeUpdate  ;Wait for DMA to complete before clearing
(2)  772/     3E7 : D4                          SEP R4
(2)  772/     3E8 : 02 B8                       dw  WAITFORSAFEUPDATE
(2)  773/     3EA :                                             
(2)  774/     3EA : F8 00                                       LDI  00H                ; clear screen
(2)  775/     3EC : BF                                          PHI  RF
(2)  776/     3ED : (MACRO)                                     CALL FillScreen
(2)  776/     3ED : D4                          SEP R4
(2)  776/     3EE : 00 75                       dw  FILLSCREEN
(2)  777/     3F0 :                                             
(2)  778/     3F0 : F8 00                                       LDI  00H                ; set x location to left margin                 
(2)  779/     3F2 : AE                                          PLO  RE
(2)  780/     3F3 :                                             
(2)  781/     3F3 : =>FALSE                             IF Resolution == "64x128"
(2)  782/     3F3 :                                             LDI  04H                ; set y location to top line                    
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 34 - 11/14/2020 15:50:57


(2)  783/     3F3 :                                             PHI  RE
(2)  784/     3F3 : [781]                               ENDIF
(2)  785/     3F3 :                                     
(2)  786/     3F3 : =>TRUE                              IF Resolution == "64x64"
(2)  787/     3F3 : F8 02                                       LDI  02H                ; set y location to top line                    
(2)  788/     3F5 : BE                                          PHI  RE
(2)  789/     3F6 : [786]                               ENDIF
(2)  790/     3F6 :                                     
(2)  791/     3F6 : =>FALSE                             IF Resolution == "64x32"
(2)  792/     3F6 :                                             LDI  01H                ; set y location to top line                    
(2)  793/     3F6 :                                             PHI  RE
(2)  794/     3F6 : [791]                               ENDIF
(2)  795/     3F6 : (MACRO)                                     CALL SetCursor          ; send cursor home
(2)  795/     3F6 : D4                          SEP R4
(2)  795/     3F7 : 04 BA                       dw  SETCURSOR
(2)  796/     3F9 :                                                             
(2)  797/     3F9 : (MACRO)                                     RETURN
(2)  797/     3F9 : D5                          SEP R5
(2)  798/     3FA :                     ;------------------------------------------------------------------------------------------
(2)  799/     3FA :                     
(2)  800/     3FA :                     ; =========================================================================================
(2)  801/     3FA :                     ; GetChar - Get Character from Hex Input.  Wait for Input press and read Ascii character
(2)  802/     3FA :                     ;               from data bus.
(2)  803/     3FA :                     ;
(2)  804/     3FA :                     ; Note: Safe - This function does not access video data
(2)  805/     3FA :                     ;
(2)  806/     3FA :                     ; Returns:
(2)  807/     3FA :                     ; RC.0          Ascii character read from hex input
(2)  808/     3FA :                     ; =========================================================================================
(2)  809/     3FA :                     
(2)  810/     3FA : 3F FA               GetChar:                BN4  GetChar            ; Wait for Input press
(2)  811/     3FC :                     
(2)  812/     3FC : 6C                                          INP  4                  ; Input stores byte in M(X)
(2)  813/     3FD :                                                             
(2)  814/     3FD : FA 7F                                       ANI  007FH              ; Ascii is only 7 bits
(2)  815/     3FF : AC                                          PLO  RC
(2)  816/     400 :                                             
(2)  817/     400 : 37 00               GC_Release:             B4   GC_Release         ; Wait for Input release
(2)  818/     402 :                     
(2)  819/     402 : (MACRO)                                     RETURN
(2)  819/     402 : D5                          SEP R5
(2)  820/     403 :                     ;------------------------------------------------------------------------------------------
(2)  821/     403 :                     
(2)  822/     403 :                     ; =========================================================================================
(2)  823/     403 :                     ; WriteHexOutput - Write a value out to the hex display
(2)  824/     403 :                     ;
(2)  825/     403 :                     ; Note: Safe - This function does not access video data
(2)  826/     403 :                     ;
(2)  827/     403 :                     ; Parameters:
(2)  828/     403 :                     ; RC.0          Value to be shown on the hex display 
(2)  829/     403 :                     ; =========================================================================================
(2)  830/     403 :                     
(2)  831/     403 : 8C                  WriteHexOutput:         GLO  RC         ; Get byte to display
(2)  832/     404 : 52                                          STR  R2         ; Put byte on the stack
(2)  833/     405 :                                             
(2)  834/     405 : 64                                          OUT  4          ; Show it. This increments stack pointer,
(2)  835/     406 : 22                                          DEC  R2         ; so back up stack pointer to point to the end.
(2)  836/     407 :                                                             
(2)  837/     407 : (MACRO)                                     RETURN
(2)  837/     407 : D5                          SEP R5
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 35 - 11/14/2020 15:50:57


(2)  838/     408 :                     ;------------------------------------------------------------------------------------------
(2)  839/     408 :                     
(2)  840/     408 :                     ; =========================================================================================
(2)  841/     408 :                     ; ReadHexInput - Read a byte from Hex Input.  Wait for Input press and read from data bus.
(2)  842/     408 :                     ;
(2)  843/     408 :                     ; Note: Safe - This function does not access video data
(2)  844/     408 :                     ;
(2)  845/     408 :                     ; Returns:
(2)  846/     408 :                     ; RC.0          Byte read from hex input
(2)  847/     408 :                     ; =========================================================================================
(2)  848/     408 : 3F 08               ReadHexInput:           BN4  ReadHexInput       ; Wait for Input press
(2)  849/     40A :                     
(2)  850/     40A : 6C                                          INP  4                  ; Input stores byte in M(X)                                     
(2)  851/     40B : AC                                          PLO  RC                 ; Save byte for return
(2)  852/     40C :                                             
(2)  853/     40C : 37 0C               RHI_Release:            B4   RHI_Release        ; Wait for Input release
(2)  854/     40E :                     
(2)  855/     40E : (MACRO)                                     RETURN                  ; return
(2)  855/     40E : D5                          SEP R5
(2)  856/     40F :                     ;------------------------------------------------------------------------------------------
(2)  857/     40F :                     
(2)  858/     40F :                     ; =========================================================================================
(2)  859/     40F :                     ; WaitForInput - Wait for Input key press and release.  No data is read.
(2)  860/     40F :                     ;
(2)  861/     40F :                     ; Note: Safe - This function does not access video data
(2)  862/     40F :                     ;
(2)  863/     40F :                     ; Returns:
(2)  864/     40F :                     ;
(2)  865/     40F :                     ; =========================================================================================
(2)  866/     40F :                     
(2)  867/     40F : 3F 0F               WaitForInput:           BN4  WaitForInput       ; Wait for Input press
(2)  868/     411 :                     
(2)  869/     411 :                                             
(2)  870/     411 : 37 11               WFI_Release:            B4   WFI_Release        ; Wait for Input release
(2)  871/     413 :                     
(2)  872/     413 : (MACRO)                                     RETURN                  ; return
(2)  872/     413 : D5                          SEP R5
(2)  873/     414 :                     ;------------------------------------------------------------------------------------------
(2)  874/     414 :                     
(2)  875/     414 :                     
(2)  876/     414 :                     ; =========================================================================================
(2)  877/     414 :                     ; PutChar - Put a character on the screen and advance the cursor
(2)  878/     414 :                     ;
(2)  879/     414 :                     ; Note: Safe - This function checks the video status before accessing video data
(2)  880/     414 :                     ;
(2)  881/     414 :                     ; Parameters:
(2)  882/     414 :                     ; RC.0          ASCII code of the character (20 - 5F)
(2)  883/     414 :                     ;
(2)  884/     414 :                     ; Internal:
(2)  885/     414 :                     ; RC.1          Temporary values
(2)  886/     414 :                     ; RE.0          X coordinate of the character
(2)  887/     414 :                     ; RE.1          Y coordinate of the character
(2)  888/     414 :                     ; RF.0          Width of character from drawCharacter
(2)  889/     414 :                     ; =========================================================================================
(2)  890/     414 : (MACRO)             PutChar:                CALL WaitForSafeUpdate
(2)  890/     414 : D4                          SEP R4
(2)  890/     415 : 02 B8                       dw  WAITFORSAFEUPDATE
(2)  891/     417 :                                             
(2)  892/     417 : (MACRO)                                     CALL WriteChar
(2)  892/     417 : D4                          SEP R4
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 36 - 11/14/2020 15:50:57


(2)  892/     418 : 04 78                       dw  WRITECHAR
(2)  893/     41A :                                             
(2)  894/     41A : =>FALSE                             IF BackBuffer <> "OFF"
(2)  895/     41A :                                             CALL CopyBackBuffer     ; update SWAP or COPY buffer
(2)  896/     41A : [894]                               ENDIF   
(2)  897/     41A :                                                             
(2)  898/     41A : (MACRO)                                     RETURN
(2)  898/     41A : D5                          SEP R5
(2)  899/     41B :                     ;------------------------------------------------------------------------------------------
(2)  900/     41B :                     
(2)  901/     41B :                     
(2)  902/     41B :                     ; =========================================================================================
(2)  903/     41B :                     ; HandleControlChar - Process a control character and move the cursor on screen
(2)  904/     41B :                     ;
(2)  905/     41B :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
(2)  906/     41B :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  907/     41B :                     ;
(2)  908/     41B :                     ; Parameters:
(2)  909/     41B :                     ; RC.0          ASCII code of the character (20 - 5F)
(2)  910/     41B :                     ; RE.0          X coordinate of the character
(2)  911/     41B :                     ; RE.1          Y coordinate of the character
(2)  912/     41B :                     
(2)  913/     41B :                     ; Internals:
(2)  914/     41B :                     ; RC.1          Temporary values
(2)  915/     41B :                     ; RF.0          Width of character 
(2)  916/     41B :                     ;
(2)  917/     41B :                     ; Returns:
(2)  918/     41B :                     ; RE.0          Updated X coordinate of the character
(2)  919/     41B :                     ; RE.1          Updated Y coordinate of the character
(2)  920/     41B :                     ; =========================================================================================
(2)  921/     41B : 8C                  HandleControlChar:      GLO  RC                 ; get the character
(2)  922/     41C : FD 0A                                       SDI  0AH                ; check for newline
(2)  923/     41E : 32 72                                       BZ   HCC_NewLine
(2)  924/     420 :                                                                                                     
(2)  925/     420 : 8C                                          GLO  RC                 ; get the character
(2)  926/     421 : FD 0D                                       SDI  0DH                ; check for carriage return
(2)  927/     423 : 32 72                                       BZ   HCC_NewLine
(2)  928/     425 :                                             
(2)  929/     425 : 8C                                          GLO  RC                 ; get the character
(2)  930/     426 : FD 0C                                       SDI  0CH                ; check for form feed
(2)  931/     428 : 32 6D                                       BZ   HCC_FormFeed
(2)  932/     42A :                     
(2)  933/     42A : 8C                                          GLO  RC                 ; get the character
(2)  934/     42B : FD 04                                       SDI  04H                ; check for end of transmission
(2)  935/     42D : 32 6D                                       BZ   HCC_FormFeed
(2)  936/     42F :                                             
(2)  937/     42F : 8C                                          GLO  RC                 ; get the character
(2)  938/     430 : FD 09                                       SDI  09H                ; check for tab
(2)  939/     432 : 32 63                                       BZ   HCC_Tab
(2)  940/     434 :                                             
(2)  941/     434 : 8C                                          GLO  RC                 ; get the character
(2)  942/     435 : FD 0B                                       SDI  0BH                ; check for vertical tab
(2)  943/     437 : 32 68                                       BZ   HCC_VTab
(2)  944/     439 :                                             
(2)  945/     439 : 8C                                          GLO  RC                 ; get the character
(2)  946/     43A : FD 08                                       SDI  08H                ; check for backspace
(2)  947/     43C : 32 5E                                       BZ   HCC_Backspace      
(2)  948/     43E :                                             
(2)  949/     43E : 8C                                          GLO  RC                 ; get the character 
(2)  950/     43F : FD 7F                                       SDI  7FH                ; check for del
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 37 - 11/14/2020 15:50:57


(2)  951/     441 : 32 59                                       BZ   HCC_Del
(2)  952/     443 :                                             
(2)  953/     443 : 8C                                          GLO  RC                 ; get the character
(2)  954/     444 : FD 18                                       SDI  18H                ; check for cancel the line
(2)  955/     446 : 32 54                                       BZ   HCC_Cancel
(2)  956/     448 :                                             
(2)  957/     448 : 8C                                          GLO  RC                 ; get character         
(2)  958/     449 : FD 1F                                       SDI  1FH                ; check for unit separator
(2)  959/     44B : 32 4D                                       BZ   HCC_Unit
(2)  960/     44D :                                             
(2)  961/     44D : (MACRO)             HCC_Unit:               CALL UnitSeparator      ; advance cursor 1 pixel column space
(2)  961/     44D : D4                          SEP R4
(2)  961/     44E : 03 D9                       dw  UNITSEPARATOR
(2)  962/     450 : 30 77                                       BR   HCC_Exit           
(2)  963/     452 :                                             
(2)  964/     452 : 30 77                                       BR   HCC_Exit           ; ignore everything else
(2)  965/     454 :                     
(2)  966/     454 : (MACRO)             HCC_Cancel:             CALL CancelLine         ; erase the current line
(2)  966/     454 : D4                          SEP R4
(2)  966/     455 : 03 E0                       dw  CANCELLINE
(2)  967/     457 : 30 77                                       BR   HCC_Exit
(2)  968/     459 :                     
(2)  969/     459 : (MACRO)             HCC_Del:                CALL Rubout             ; del backs up and rubs out one column                  
(2)  969/     459 : D4                          SEP R4
(2)  969/     45A : 03 CF                       dw  RUBOUT
(2)  970/     45C : 30 77                                       BR   HCC_Exit
(2)  971/     45E :                                             
(2)  972/     45E : (MACRO)             HCC_Backspace:          CALL Backspace          ; move cursor back and delete a character
(2)  972/     45E : D4                          SEP R4
(2)  972/     45F : 03 1F                       dw  BACKSPACE
(2)  973/     461 : 30 77                                       BR   HCC_Exit           
(2)  974/     463 :                     
(2)  975/     463 : (MACRO)             HCC_Tab:                CALL TabCursor          ; move to next tab stop
(2)  975/     463 : D4                          SEP R4
(2)  975/     464 : 03 11                       dw  TABCURSOR
(2)  976/     466 : 30 77                                       BR   HCC_Exit
(2)  977/     468 :                                             
(2)  978/     468 : (MACRO)             HCC_VTab:               CALL DownCursor         ; move to next line, same x position
(2)  978/     468 : D4                          SEP R4
(2)  978/     469 : 03 4B                       dw  DOWNCURSOR
(2)  979/     46B : 30 77                                       BR   HCC_Exit
(2)  980/     46D :                     
(2)  981/     46D : (MACRO)             HCC_FormFeed:           CALL ClearScreen        ; form feed clears the screen                   
(2)  981/     46D : D4                          SEP R4
(2)  981/     46E : 03 E7                       dw  CLEARSCREEN
(2)  982/     470 : 30 77                                       BR   HCC_Exit           
(2)  983/     472 :                                                                                                     
(2)  984/     472 : (MACRO)             HCC_NewLine:            CALL NextLine           ; go to next line and end                       
(2)  984/     472 : D4                          SEP R4
(2)  984/     473 : 03 3C                       dw  NEXTLINE
(2)  985/     475 : 30 77                                       BR   HCC_Exit
(2)  986/     477 :                                                                             
(2)  987/     477 : (MACRO)             HCC_Exit:               RETURN
(2)  987/     477 : D5                          SEP R5
(2)  988/     478 :                     ;------------------------------------------------------------------------------------------
(2)  989/     478 :                     
(2)  990/     478 :                     ; =========================================================================================
(2)  991/     478 :                     ; WriteChar - Write a character on the screen and advance the cursor
(2)  992/     478 :                     ;
(2)  993/     478 :                     ; Note: *** UNSAFE *** This function does not check before accessing video data.
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 38 - 11/14/2020 15:50:57


(2)  994/     478 :                     ;               Must call WaitForSafeUpdate function before calling this function.
(2)  995/     478 :                     ;
(2)  996/     478 :                     ; Parameters:
(2)  997/     478 :                     ; RC.0          ASCII code of the character (20 - 5F)
(2)  998/     478 :                     ;
(2)  999/     478 :                     ; Internal:
(2) 1000/     478 :                     ; RC.1          Temporary values
(2) 1001/     478 :                     ; RE.0          X coordinate of the character
(2) 1002/     478 :                     ; RE.1          Y coordinate of the character
(2) 1003/     478 :                     ; RF.0          Width of character from drawCharacter
(2) 1004/     478 :                     ; =========================================================================================
(2) 1005/     478 :                     
(2) 1006/     478 : (MACRO)             WriteChar:              CALL GetCursor
(2) 1006/     478 : D4                          SEP R4
(2) 1006/     479 : 04 CB                       dw  GETCURSOR
(2) 1007/     47B :                                                                                     
(2) 1008/     47B : 8E                                          GLO  RE                 ; get the x location
(2) 1009/     47C :                                                                                                                             
(2) 1010/     47C : 3A 81                                       BNZ  WC_SetChar         ; check for beginning of new line
(2) 1011/     47E : (MACRO)                                     CALL BlankLine          ; if at begining, blank the line
(2) 1011/     47E : D4                          SEP R4
(2) 1011/     47F : 02 FE                       dw  BLANKLINE
(2) 1012/     481 :                                             
(2) 1013/     481 : 8C                  WC_SetChar:             GLO  RC                 ; check for DEL the only control char
(2) 1014/     482 : FD 7F                                       SDI  7FH                ; that is greater than 20H
(2) 1015/     484 : 32 8B                                       BZ   WC_Control         
(2) 1016/     486 :                                                                                                                                             
(2) 1017/     486 : 8C                                          GLO  RC                 ; get the character
(2) 1018/     487 : FF 20                                       SMI  20H                ; check for any printable character
(2) 1019/     489 : 33 90                                       BGE  WC_Draw            
(2) 1020/     48B :                                                                                                     
(2) 1021/     48B : (MACRO)             WC_Control:             CALL HandleControlChar  ; everthing else is a control character
(2) 1021/     48B : D4                          SEP R4
(2) 1021/     48C : 04 1B                       dw  HANDLECONTROLCHAR
(2) 1022/     48E : 30 9F                                       BR   WC_UpdateCursor    ; save cursor changes after control char
(2) 1023/     490 :                                                     
(2) 1024/     490 : 8E                  WC_Draw:                GLO  RE                 ; push RE with cursor location onto the stack
(2) 1025/     491 : 73                                          STXD
(2) 1026/     492 : 9E                                          GHI  RE
(2) 1027/     493 : 73                                          STXD 
(2) 1028/     494 :                                             
(2) 1029/     494 : (MACRO)                                     CALL DrawCharacter      ; write the chracter
(2) 1029/     494 : D4                          SEP R4
(2) 1029/     495 : 01 00                       dw  DRAWCHARACTER
(2) 1030/     497 :                                                                                     
(2) 1031/     497 : 60                                          IRX                                     
(2) 1032/     498 : 72                                          LDXA
(2) 1033/     499 : BE                                          PHI  RE                 ; restore RE with cursor location
(2) 1034/     49A : F0                                          LDX
(2) 1035/     49B : AE                                          PLO  RE                         
(2) 1036/     49C :                                             
(2) 1037/     49C : (MACRO)                                     CALL RightCursor        ; advance cursor by character width + 1
(2) 1037/     49C : D4                          SEP R4
(2) 1037/     49D : 03 B4                       dw  RIGHTCURSOR
(2) 1038/     49F :                                             
(2) 1039/     49F : (MACRO)             WC_UpdateCursor:        CALL SetCursor
(2) 1039/     49F : D4                          SEP R4
(2) 1039/     4A0 : 04 BA                       dw  SETCURSOR
(2) 1040/     4A2 :                                                             
(2) 1041/     4A2 : (MACRO)             WC_Exit:                RETURN
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 39 - 11/14/2020 15:50:57


(2) 1041/     4A2 : D5                          SEP R5
(2) 1042/     4A3 :                     ;------------------------------------------------------------------------------------------
(2) 1043/     4A3 :                     
(2) 1044/     4A3 :                     ; =========================================================================================
(2) 1045/     4A3 :                     ; PutString - Read characters from a string and write to video until a null is read.
(2) 1046/     4A3 :                     ; Parameters:
(2) 1047/     4A3 :                     ; RF    - pointer to String
(2) 1048/     4A3 :                     ;
(2) 1049/     4A3 :                     ; Note: Safe - This function checks the video status before accessing video data
(2) 1050/     4A3 :                     ;
(2) 1051/     4A3 :                     ; Internal:
(2) 1052/     4A3 :                     ; RC.0  - character value read from input
(2) 1053/     4A3 :                     ; =========================================================================================
(2) 1054/     4A3 :                     
(2) 1055/     4A3 : (MACRO)             PutString:              CALL WaitForSafeUpdate  
(2) 1055/     4A3 : D4                          SEP R4
(2) 1055/     4A4 : 02 B8                       dw  WAITFORSAFEUPDATE
(2) 1056/     4A6 :                     
(2) 1057/     4A6 : 0F                  PS_WriteString:         LDN  RF                 ; get character, exit if 0 (null)
(2) 1058/     4A7 : AC                                          PLO  RC
(2) 1059/     4A8 : 32 B9                                       BZ   PS_Exit
(2) 1060/     4AA : 1F                                          INC  RF
(2) 1061/     4AB :                                                             
(2) 1062/     4AB : 8F                                          GLO  RF                 ; push RF onto the stack
(2) 1063/     4AC : 73                                          STXD
(2) 1064/     4AD : 9F                                          GHI  RF
(2) 1065/     4AE : 73                                          STXD
(2) 1066/     4AF :                                     
(2) 1067/     4AF :                                                             
(2) 1068/     4AF : (MACRO)                                     CALL WriteChar          ; write character to video
(2) 1068/     4AF : D4                          SEP R4
(2) 1068/     4B0 : 04 78                       dw  WRITECHAR
(2) 1069/     4B2 :                                                                     ; ok to use write since we know it's safe
(2) 1070/     4B2 :                                             
(2) 1071/     4B2 : 60                                          IRX                     ; restore RF from stack
(2) 1072/     4B3 : 72                                          LDXA
(2) 1073/     4B4 : BF                                          PHI  RF
(2) 1074/     4B5 : F0                                          LDX
(2) 1075/     4B6 : AF                                          PLO  RF
(2) 1076/     4B7 :                                                             
(2) 1077/     4B7 : 30 A6                                       BR PS_WriteString       ; continue with next character until null
(2) 1078/     4B9 :                                             
(2) 1079/     4B9 :                     
(2) 1080/     4B9 : =>FALSE             PS_Exit:        IF BackBuffer <> "OFF"
(2) 1081/     4B9 :                                             CALL CopyBackBuffer     ; update SWAP or COPY buffer
(2) 1082/     4B9 : [1080]                              ENDIF   
(2) 1083/     4B9 :                     
(2) 1084/     4B9 : (MACRO)                                     RETURN
(2) 1084/     4B9 : D5                          SEP R5
(2) 1085/     4BA :                     ;------------------------------------------------------------------------------------------
(2) 1086/     4BA :                     ; =========================================================================================
(2) 1087/     4BA :                     ; SetCursor - Save the Cursor value into memory
(2) 1088/     4BA :                     ;
(2) 1089/     4BA :                     ; Note: Safe - This function does not access video data
(2) 1090/     4BA :                     ;
(2) 1091/     4BA :                     ; Parameters:
(2) 1092/     4BA :                     ; RE.0          X coordinate of the character
(2) 1093/     4BA :                     ; RE.1          Y coordinate of the character
(2) 1094/     4BA :                     ;
(2) 1095/     4BA :                     ; Internal:
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Tty1861.asm) - Page 40 - 11/14/2020 15:50:57


(2) 1096/     4BA :                     ; RD            Pointer to CursorY and CursorX
(2) 1097/     4BA :                     ; =========================================================================================
(2) 1098/     4BA : (MACRO)             SetCursor:              LOAD RD, CursorX        ; set the x cursor                                                      
(2) 1098/     4BA : F8 05                       LDI  lo(CURSORX)
(2) 1098/     4BC : AD                          PLO  RD
(2) 1098/     4BD : F8 7F                       LDI  hi(CURSORX)
(2) 1098/     4BF : BD                          PHI  RD     
(2) 1099/     4C0 : 8E                                          GLO  RE                 ; get character x location
(2) 1100/     4C1 : 5D                                          STR  RD                 ; save the x cursor value       
(2) 1101/     4C2 :                                                                                                             
(2) 1102/     4C2 : (MACRO)                                     LOAD RD, CursorY        ; set the y cursor                                                                                                      
(2) 1102/     4C2 : F8 06                       LDI  lo(CURSORY)
(2) 1102/     4C4 : AD                          PLO  RD
(2) 1102/     4C5 : F8 7F                       LDI  hi(CURSORY)
(2) 1102/     4C7 : BD                          PHI  RD     
(2) 1103/     4C8 : 9E                                          GHI  RE                 ; get character y location
(2) 1104/     4C9 : 5D                                          STR  RD                 ; save the y cursor value                                                                                               
(2) 1105/     4CA :                                                             
(2) 1106/     4CA : (MACRO)                                     RETURN
(2) 1106/     4CA : D5                          SEP R5
(2) 1107/     4CB :                     ;------------------------------------------------------------------------------------------
(2) 1108/     4CB :                     
(2) 1109/     4CB :                     ; =========================================================================================
(2) 1110/     4CB :                     ; GetCursor - Read the Cursor value from memory
(2) 1111/     4CB :                     ; 
(2) 1112/     4CB :                     ; Note: Safe - This function does not access video data
(2) 1113/     4CB :                     :
(2) 1114/     4CB :                     ; Parameters:
(2) 1115/     4CB :                     ;
(2) 1116/     4CB :                     ; Internal:
(2) 1117/     4CB :                     ; RD            Pointer to CursorY and CursorX
(2) 1118/     4CB :                     ;
(2) 1119/     4CB :                     ; Returns:
(2) 1120/     4CB :                     ; RE.0          X coordinate of the character
(2) 1121/     4CB :                     ; RE.1          Y coordinate of the character
(2) 1122/     4CB :                     ; =========================================================================================
(2) 1123/     4CB : (MACRO)             GetCursor:              LOAD RD, CursorX        ; get the x cursor                                                      
(2) 1123/     4CB : F8 05                       LDI  lo(CURSORX)
(2) 1123/     4CD : AD                          PLO  RD
(2) 1123/     4CE : F8 7F                       LDI  hi(CURSORX)
(2) 1123/     4D0 : BD                          PHI  RD     
(2) 1124/     4D1 : 0D                                          LDN  RD                 ; load the x cursor value                                       
(2) 1125/     4D2 : AE                                          PLO  RE                 ; set character x location
(2) 1126/     4D3 :                                             
(2) 1127/     4D3 : (MACRO)                                     LOAD RD, CursorY        ; get the y cursor                                                                              
(2) 1127/     4D3 : F8 06                       LDI  lo(CURSORY)
(2) 1127/     4D5 : AD                          PLO  RD
(2) 1127/     4D6 : F8 7F                       LDI  hi(CURSORY)
(2) 1127/     4D8 : BD                          PHI  RD     
(2) 1128/     4D9 : 0D                                          LDN  RD                 ; load the y cursor value                                                                                       
(2) 1129/     4DA : BE                                          PHI  RE                 ; set character y location
(2) 1130/     4DB :                                                             
(2) 1131/     4DB : (MACRO)                                     RETURN
(2) 1131/     4DB : D5                          SEP R5
(2) 1132/     4DC :                     ;------------------------------------------------------------------------------------------
(2) 1133/     4DC :                     
(2) 1134/     4DC :                     
(2) 1135/     4DC :                     
(2) 1136/     4DC : [23]                                                        ENDIF
(1)  130/     4DC : [121]                               ENDIF
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Initialize.asm) - Page 41 - 11/14/2020 15:50:57


(1)  131/     4DC :                     
(1)  132/     4DC : =>FALSE                             IF Resolution == "64x32"
(1)  133/     4DC :                                             IF BackBuffer == "OFF"
(1)  134/     4DC :                                                     INCLUDE "Text1861.asm"
(1)  135/     4DC :                                                     INCLUDE "Fonts.asm"
(1)  136/     4DC :                                                     INCLUDE "Tty1861.asm"
(1)  137/     4DC : [133]                                       ENDIF
(1)  138/     4DC :                     
(1)  139/     4DC :                                             IF BackBuffer == "COPY"
(1)  140/     4DC :                                                     INCLUDE "Fonts.asm"
(1)  141/     4DC :                                                     INCLUDE "Text1861.asm"
(1)  142/     4DC :                                                     INCLUDE "Tty1861.asm"
(1)  143/     4DC : [139]                                       ENDIF
(1)  144/     4DC :                     
(1)  145/     4DC :                                             IF BackBuffer == "SWAP"
(1)  146/     4DC :                                                     INCLUDE "Tty1861.asm"
(1)  147/     4DC :                                                     INCLUDE "Text1861.asm"
(1)  148/     4DC :                                                     INCLUDE "Fonts.asm"
(1)  149/     4DC : [145]                                       ENDIF
(1)  150/     4DC :                     
(1)  151/     4DC : [132]                               ENDIF
(1)  152/     4DC :                     
(1)  153/     4DC :                                             ; pad assembled code to end of page to avoid page boundary errors
(1)  154/     4DC :                                                     INCLUDE "Padding.asm"  
(2)    1/     4DC :                     ; *****************************************************************************************
(2)    2/     4DC :                     ; Padding - Code with 64x64 or 64x128 resolution and the Swap or Copy BackBuffer option
(2)    3/     4DC :                     ;           assembles to near the end of a page boundary.  This file contains padding
(2)    4/     4DC :                     ;           definitions to prevent errors in user code caused by branches straddling a page
(2)    5/     4DC :                     ;           boundary.  This can cause 'jump target not on same page' errors when assembling
(2)    6/     4DC :                     ;           user code.  Padding values greater than 32 bytes are commented out.
(2)    7/     4DC :                     ;
(2)    8/     4DC :                     ; Copyright (c) 2020 by Gaston Williams
(2)    9/     4DC :                     ;
(2)   10/     4DC :                     ; Changes:
(2)   11/     4DC :                     ; Sept, 2020 - Added padding definitions for 64x128 resolution
(2)   12/     4DC :                     ; *****************************************************************************************
(2)   13/     4DC :                     
(2)   14/     4DC :                     ; =========================================================================================
(2)   15/     4DC :                     ; Padding definitions for more than 16 bytes are commented out.
(2)   16/     4DC :                     ; =========================================================================================
(2)   17/     4DC :                     
(2)   18/     4DC : =>FALSE                             IF Resolution == "64x128"
(2)   19/     4DC :                                             ; 64x128 resolution user code when assembled with the BackBuffer option "COPY"
(2)   20/     4DC :                                             ; ends exactly on a page boundary so no padding is needed
(2)   21/     4DC :                                             ;IF BackBuffer == "COPY"
(2)   22/     4DC :                                             ;        db 0 dup 00H
(2)   23/     4DC :                                             ;ENDIF
(2)   24/     4DC :                     
(2)   25/     4DC :                                             IF BackBuffer == "SWAP"
(2)   26/     4DC :                                                     db 6 dup 00H
(2)   27/     4DC : [25]                                        ENDIF
(2)   28/     4DC :                     
(2)   29/     4DC :                                             ; Uncomment the lines below if there's a boundary issue with 64x128
(2)   30/     4DC :                                             ; resolution user code when assembled with the BackBuffer option "OFF"
(2)   31/     4DC :                     
(2)   32/     4DC :                                             ;IF BackBuffer == "OFF"
(2)   33/     4DC :                                             ;       db 22H dup 00H
(2)   34/     4DC :                                             ;ENDIF
(2)   35/     4DC :                     
(2)   36/     4DC : [18]                                ENDIF
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm(Padding.asm) - Page 42 - 11/14/2020 15:50:57


(2)   37/     4DC :                     
(2)   38/     4DC : =>TRUE                              IF Resolution == "64x64"
(2)   39/     4DC : =>FALSE                                     IF BackBuffer == "COPY"
(2)   40/     4DC :                                                     db 2 dup 00H
(2)   41/     4DC : [39]                                        ENDIF
(2)   42/     4DC :                     
(2)   43/     4DC : =>FALSE                                     IF BackBuffer == "SWAP"
(2)   44/     4DC :                                                     db 8 dup 00H
(2)   45/     4DC : [43]                                        ENDIF
(2)   46/     4DC :                     
(2)   47/     4DC :                                             ; Uncomment the lines below if there's a boundary issue with 64x64
(2)   48/     4DC :                                             ; resolution user code when assembled with the BackBuffer option "OFF"
(2)   49/     4DC :                     
(2)   50/     4DC :                                             ;IF BackBuffer == "OFF"
(2)   51/     4DC :                                             ;       db 24H dup 00H
(2)   52/     4DC :                                             ;ENDIF
(2)   53/     4DC :                     
(2)   54/     4DC : [38]                                ENDIF
(2)   55/     4DC :                     
(2)   56/     4DC : =>FALSE                             IF Resolution == "64x32"
(2)   57/     4DC :                                             IF BackBuffer == "COPY"
(2)   58/     4DC :                                                    db 13H dup 00H
(2)   59/     4DC : [57]                                        ENDIF
(2)   60/     4DC :                     
(2)   61/     4DC :                                             IF BackBuffer == "SWAP"
(2)   62/     4DC :                                                    db 1BH dup 00H
(2)   63/     4DC : [61]                                        ENDIF
(2)   64/     4DC :                     
(2)   65/     4DC :                                             ; Uncomment the lines below if there's a boundary issue with 64x32
(2)   66/     4DC :                                             ; resolution user code when assembled with the BackBuffer option "OFF"
(2)   67/     4DC :                     
(2)   68/     4DC :                                             ;IF BackBuffer == "OFF"
(2)   69/     4DC :                                             ;       db 33H dup 00H
(2)   70/     4DC :                                             ;ENDIF
(2)   71/     4DC :                     
(2)   72/     4DC : [56]                                ENDIF
(2)   73/     4DC :                     ;------------------------------------------------------------------------------------------
(2)   74/     4DC :                     
(1)  155/     4DC :                     
      16/     4DC :                     
      17/     4DC :                     ; =========================================================================================
      18/     4DC :                     ; Main
      19/     4DC :                     ; =========================================================================================
      20/     4DC :                     
      21/     4DC : (MACRO)             Start:                          CALL BeginTerminal      ; set up video buffers and variables
      21/     4DC : D4                          SEP R4
      21/     4DD : 02 9C                       dw  BEGINTERMINAL
      22/     4DF :                     
      23/     4DF : =>FALSE                                     IF BackBuffer <> "OFF"
      24/     4DF :                                                     CALL CopyBackBuffer     ; clear back buffers
      25/     4DF : [23]                                        ENDIF
      26/     4DF :                     
      27/     4DF : (MACRO)             MainLoop:                       CALL Text
      27/     4DF : D4                          SEP R4
      27/     4E0 : 04 E7                       dw  TEXT
      28/     4E2 : (MACRO)                                             CALL BigSprites
      28/     4E2 : D4                          SEP R4
      28/     4E3 : 05 3C                       dw  BIGSPRITES
      29/     4E5 :                     
      30/     4E5 : 30 DF                                               BR   MainLoop
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 43 - 11/14/2020 15:50:57


      31/     4E7 :                     ;------------------------------------------------------------------------------------------
      32/     4E7 :                     
      33/     4E7 :                     
      34/     4E7 :                     ; =========================================================================================
      35/     4E7 :                     ; Let's show off the 96 character font:
      36/     4E7 :                     ; =========================================================================================
      37/     4E7 :                     
      38/     4E7 : (MACRO)             Text:                           CALL ClearScreen
      38/     4E7 : D4                          SEP R4
      38/     4E8 : 03 E7                       dw  CLEARSCREEN
      39/     4EA :                     
      40/     4EA : (MACRO)                                             LOAD RF, FontTitle
      40/     4EA : F8 4A                       LDI  lo(FONTTITLE)
      40/     4EC : AF                          PLO  RF
      40/     4ED : F8 06                       LDI  hi(FONTTITLE)
      40/     4EF : BF                          PHI  RF     
      41/     4F0 : (MACRO)                                             CALL PutString
      41/     4F0 : D4                          SEP R4
      41/     4F1 : 04 A3                       dw  PUTSTRING
      42/     4F3 :                     
      43/     4F3 : (MACRO)                                             LOAD RF, Font1
      43/     4F3 : F8 5B                       LDI  lo(FONT1)
      43/     4F5 : AF                          PLO  RF
      43/     4F6 : F8 06                       LDI  hi(FONT1)
      43/     4F8 : BF                          PHI  RF     
      44/     4F9 : (MACRO)                                             CALL PutString
      44/     4F9 : D4                          SEP R4
      44/     4FA : 04 A3                       dw  PUTSTRING
      45/     4FC :                     
      46/     4FC : (MACRO)                                             LOAD RF, Font2
      46/     4FC : F8 6C                       LDI  lo(FONT2)
      46/     4FE : AF                          PLO  RF
      46/     4FF : F8 06                       LDI  hi(FONT2)
      46/     501 : BF                          PHI  RF     
      47/     502 : (MACRO)                                             CALL PutString
      47/     502 : D4                          SEP R4
      47/     503 : 04 A3                       dw  PUTSTRING
      48/     505 :                     
      49/     505 : (MACRO)                                             LOAD RF, Font3
      49/     505 : F8 7D                       LDI  lo(FONT3)
      49/     507 : AF                          PLO  RF
      49/     508 : F8 06                       LDI  hi(FONT3)
      49/     50A : BF                          PHI  RF     
      50/     50B : (MACRO)                                             CALL PutString
      50/     50B : D4                          SEP R4
      50/     50C : 04 A3                       dw  PUTSTRING
      51/     50E :                     
      52/     50E : (MACRO)                                             LOAD RF, Font4
      52/     50E : F8 8D                       LDI  lo(FONT4)
      52/     510 : AF                          PLO  RF
      52/     511 : F8 06                       LDI  hi(FONT4)
      52/     513 : BF                          PHI  RF     
      53/     514 : (MACRO)                                             CALL PutString
      53/     514 : D4                          SEP R4
      53/     515 : 04 A3                       dw  PUTSTRING
      54/     517 :                     
      55/     517 : (MACRO)                                             LOAD RF, Font5
      55/     517 : F8 9D                       LDI  lo(FONT5)
      55/     519 : AF                          PLO  RF
      55/     51A : F8 06                       LDI  hi(FONT5)
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 44 - 11/14/2020 15:50:57


      55/     51C : BF                          PHI  RF     
      56/     51D : (MACRO)                                             CALL PutString
      56/     51D : D4                          SEP R4
      56/     51E : 04 A3                       dw  PUTSTRING
      57/     520 :                     
      58/     520 : (MACRO)                                             LOAD RF, Font6
      58/     520 : F8 AF                       LDI  lo(FONT6)
      58/     522 : AF                          PLO  RF
      58/     523 : F8 06                       LDI  hi(FONT6)
      58/     525 : BF                          PHI  RF     
      59/     526 : (MACRO)                                             CALL PutString
      59/     526 : D4                          SEP R4
      59/     527 : 04 A3                       dw  PUTSTRING
      60/     529 :                     
      61/     529 : (MACRO)                                             LOAD RF, PressI
      61/     529 : F8 D0                       LDI  lo(PRESSI)
      61/     52B : AF                          PLO  RF
      61/     52C : F8 06                       LDI  hi(PRESSI)
      61/     52E : BF                          PHI  RF     
      62/     52F : (MACRO)                                             CALL PutString
      62/     52F : D4                          SEP R4
      62/     530 : 04 A3                       dw  PUTSTRING
      63/     532 :                     
      64/     532 : =>FALSE                                     IF BackBuffer <> "OFF"
      65/     532 :                                                     CALL CopyBackBuffer     ; update swap or copy buffer
      66/     532 : [64]                                        ENDIF
      67/     532 :                     
      68/     532 : (MACRO)                                             CALL VideoOn            ; show text
      68/     532 : D4                          SEP R4
      68/     533 : 02 A7                       dw  VIDEOON
      69/     535 : (MACRO)                                             CALL WaitForInput
      69/     535 : D4                          SEP R4
      69/     536 : 04 0F                       dw  WAITFORINPUT
      70/     538 :                     
      71/     538 : (MACRO)                                             CALL VideoOff           ; hide text while drawing graphics
      71/     538 : D4                          SEP R4
      71/     539 : 02 AF                       dw  VIDEOOFF
      72/     53B : (MACRO)                                             RETURN
      72/     53B : D5                          SEP R5
      73/     53C :                     ;------------------------------------------------------------------------------------------
      74/     53C :                     
      75/     53C :                     
      76/     53C :                     ; =========================================================================================
      77/     53C :                     ; Let's draw some big sprites
      78/     53C :                     ; =========================================================================================
      79/     53C :                     
      80/     53C : (MACRO)             BigSprites:                     CALL ClearScreen
      80/     53C : D4                          SEP R4
      80/     53D : 03 E7                       dw  CLEARSCREEN
      81/     53F :                     
      82/     53F : F8 08                                               LDI  0008H              ; The Klingon ship is actually made
      83/     541 : AE                                                  PLO  RE                 ; up of four sprites drawn next to
      84/     542 : F8 07                                               LDI  0007H              ; each other.
      85/     544 : BE                                                  PHI  RE
      86/     545 :                     
      87/     545 : (MACRO)                                             LOAD RF, Klingon_0
      87/     545 : F8 F7                       LDI  lo(KLINGON_0)
      87/     547 : AF                          PLO  RF
      87/     548 : F8 05                       LDI  hi(KLINGON_0)
      87/     54A : BF                          PHI  RF     
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 45 - 11/14/2020 15:50:57


      88/     54B :                     
      89/     54B : F8 0F                                               LDI  000FH
      90/     54D : AD                                                  PLO  RD
      91/     54E : (MACRO)                                             CALL DrawSprite
      91/     54E : D4                          SEP R4
      91/     54F : 00 89                       dw  DRAWSPRITE
      92/     551 :                     
      93/     551 : F8 10                                               LDI  0010H
      94/     553 : AE                                                  PLO  RE
      95/     554 : F8 00                                               LDI  0000H
      96/     556 : BE                                                  PHI  RE
      97/     557 :                     
      98/     557 : (MACRO)                                             LOAD RF, Klingon_1
      98/     557 : F8 06                       LDI  lo(KLINGON_1)
      98/     559 : AF                          PLO  RF
      98/     55A : F8 06                       LDI  hi(KLINGON_1)
      98/     55C : BF                          PHI  RF     
      99/     55D :                     
     100/     55D : F8 0E                                               LDI  000EH
     101/     55F : AD                                                  PLO  RD
     102/     560 : (MACRO)                                             CALL DrawSprite
     102/     560 : D4                          SEP R4
     102/     561 : 00 89                       dw  DRAWSPRITE
     103/     563 :                     
     104/     563 : F8 18                                               LDI  0018H
     105/     565 : AE                                                  PLO  RE
     106/     566 : F8 03                                               LDI  0003H
     107/     568 : BE                                                  PHI  RE
     108/     569 :                     
     109/     569 : (MACRO)                                             LOAD RF, Klingon_2
     109/     569 : F8 14                       LDI  lo(KLINGON_2)
     109/     56B : AF                          PLO  RF
     109/     56C : F8 06                       LDI  hi(KLINGON_2)
     109/     56E : BF                          PHI  RF     
     110/     56F :                     
     111/     56F : F8 0B                                               LDI  000BH
     112/     571 : AD                                                  PLO  RD
     113/     572 : (MACRO)                                             CALL DrawSprite
     113/     572 : D4                          SEP R4
     113/     573 : 00 89                       dw  DRAWSPRITE
     114/     575 :                     
     115/     575 : F8 20                                               LDI  0020H
     116/     577 : AE                                                  PLO  RE
     117/     578 : F8 0C                                               LDI  000CH
     118/     57A : BE                                                  PHI  RE
     119/     57B :                     
     120/     57B : (MACRO)                                             LOAD RF, Klingon_3
     120/     57B : F8 1F                       LDI  lo(KLINGON_3)
     120/     57D : AF                          PLO  RF
     120/     57E : F8 06                       LDI  hi(KLINGON_3)
     120/     580 : BF                          PHI  RF     
     121/     581 :                     
     122/     581 : F8 0A                                               LDI  000AH
     123/     583 : AD                                                  PLO  RD
     124/     584 : (MACRO)                                             CALL DrawSprite
     124/     584 : D4                          SEP R4
     124/     585 : 00 89                       dw  DRAWSPRITE
     125/     587 :                     
     126/     587 : F8 20                                               LDI  0020H              ; same with the Romulans
     127/     589 : AE                                                  PLO  RE
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 46 - 11/14/2020 15:50:57


     128/     58A : F8 20                                               LDI  0020H
     129/     58C : BE                                                  PHI  RE
     130/     58D :                     
     131/     58D : (MACRO)                                             LOAD RF, Romulan_0
     131/     58D : F8 29                       LDI  lo(ROMULAN_0)
     131/     58F : AF                          PLO  RF
     131/     590 : F8 06                       LDI  hi(ROMULAN_0)
     131/     592 : BF                          PHI  RF     
     132/     593 :                     
     133/     593 : F8 0B                                               LDI  000BH
     134/     595 : AD                                                  PLO  RD
     135/     596 : (MACRO)                                             CALL DrawSprite
     135/     596 : D4                          SEP R4
     135/     597 : 00 89                       dw  DRAWSPRITE
     136/     599 :                     
     137/     599 : F8 28                                               LDI  0028H
     138/     59B : AE                                                  PLO  RE
     139/     59C : F8 25                                               LDI  0025H
     140/     59E : BE                                                  PHI  RE
     141/     59F :                     
     142/     59F : (MACRO)                                             LOAD RF, Romulan_1
     142/     59F : F8 34                       LDI  lo(ROMULAN_1)
     142/     5A1 : AF                          PLO  RF
     142/     5A2 : F8 06                       LDI  hi(ROMULAN_1)
     142/     5A4 : BF                          PHI  RF     
     143/     5A5 :                     
     144/     5A5 : F8 08                                               LDI  0008H
     145/     5A7 : AD                                                  PLO  RD
     146/     5A8 : (MACRO)                                             CALL DrawSprite
     146/     5A8 : D4                          SEP R4
     146/     5A9 : 00 89                       dw  DRAWSPRITE
     147/     5AB :                     
     148/     5AB : F8 30                                               LDI  0030H
     149/     5AD : AE                                                  PLO  RE
     150/     5AE : F8 26                                               LDI  0026H
     151/     5B0 : BE                                                  PHI  RE
     152/     5B1 :                     
     153/     5B1 : (MACRO)                                             LOAD RF, Romulan_2
     153/     5B1 : F8 3C                       LDI  lo(ROMULAN_2)
     153/     5B3 : AF                          PLO  RF
     153/     5B4 : F8 06                       LDI  hi(ROMULAN_2)
     153/     5B6 : BF                          PHI  RF     
     154/     5B7 :                     
     155/     5B7 : F8 06                                               LDI  0006H
     156/     5B9 : AD                                                  PLO  RD
     157/     5BA : (MACRO)                                             CALL DrawSprite
     157/     5BA : D4                          SEP R4
     157/     5BB : 00 89                       dw  DRAWSPRITE
     158/     5BD :                     
     159/     5BD : F8 38                                               LDI  0038H
     160/     5BF : AE                                                  PLO  RE
     161/     5C0 : F8 20                                               LDI  0020H
     162/     5C2 : BE                                                  PHI  RE
     163/     5C3 :                     
     164/     5C3 : (MACRO)                                             LOAD RF, Romulan_3
     164/     5C3 : F8 42                       LDI  lo(ROMULAN_3)
     164/     5C5 : AF                          PLO  RF
     164/     5C6 : F8 06                       LDI  hi(ROMULAN_3)
     164/     5C8 : BF                          PHI  RF     
     165/     5C9 :                     
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 47 - 11/14/2020 15:50:57


     166/     5C9 : F8 08                                               LDI  0008H
     167/     5CB : AD                                                  PLO  RD
     168/     5CC : (MACRO)                                             CALL DrawSprite
     168/     5CC : D4                          SEP R4
     168/     5CD : 00 89                       dw  DRAWSPRITE
     169/     5CF :                     
     170/     5CF : (MACRO)                                             LOAD RF, SpriteTitle
     170/     5CF : F8 C3                       LDI  lo(SPRITETITLE)
     170/     5D1 : AF                          PLO  RF
     170/     5D2 : F8 06                       LDI  hi(SPRITETITLE)
     170/     5D4 : BF                          PHI  RF     
     171/     5D5 :                     
     172/     5D5 : F8 0D                                               LDI  0DH
     173/     5D7 : AE                                                  PLO  RE
     174/     5D8 : F8 32                                               LDI  32H
     175/     5DA : BE                                                  PHI  RE
     176/     5DB :                     
     177/     5DB : (MACRO)                                             CALL DrawString
     177/     5DB : D4                          SEP R4
     177/     5DC : 00 DB                       dw  DRAWSTRING
     178/     5DE :                     
     179/     5DE : (MACRO)                                             LOAD RF, PressI
     179/     5DE : F8 D0                       LDI  lo(PRESSI)
     179/     5E0 : AF                          PLO  RF
     179/     5E1 : F8 06                       LDI  hi(PRESSI)
     179/     5E3 : BF                          PHI  RF     
     180/     5E4 :                     
     181/     5E4 : F8 08                                               LDI  08H
     182/     5E6 : AE                                                  PLO  RE
     183/     5E7 : F8 38                                               LDI  38H
     184/     5E9 : BE                                                  PHI  RE
     185/     5EA :                     
     186/     5EA : (MACRO)                                             CALL DrawString
     186/     5EA : D4                          SEP R4
     186/     5EB : 00 DB                       dw  DRAWSTRING
     187/     5ED :                     
     188/     5ED : =>FALSE                                     IF BackBuffer <> "OFF"
     189/     5ED :                                                     CALL CopyBackBuffer     ; update swap or copy buffer
     190/     5ED : [188]                                       ENDIF
     191/     5ED : (MACRO)                                             CALL VideoOn            ; show graphics
     191/     5ED : D4                          SEP R4
     191/     5EE : 02 A7                       dw  VIDEOON
     192/     5F0 : (MACRO)                                             CALL WaitForInput
     192/     5F0 : D4                          SEP R4
     192/     5F1 : 04 0F                       dw  WAITFORINPUT
     193/     5F3 :                     
     194/     5F3 : (MACRO)                                             CALL VideoOff           ; hide graphics while drawing text
     194/     5F3 : D4                          SEP R4
     194/     5F4 : 02 AF                       dw  VIDEOOFF
     195/     5F6 : (MACRO)                                             RETURN
     195/     5F6 : D5                          SEP R5
     196/     5F7 :                     ;------------------------------------------------------------------------------------------
     197/     5F7 :                     
     198/     5F7 :                     
     199/     5F7 :                     ; =========================================================================================
     200/     5F7 :                     ; Graphics
     201/     5F7 :                     ; =========================================================================================
     202/     5F7 :                     
     203/     5F7 : 01 03 07 0F 0F 1F   Klingon_0       db 0001H, 0003H, 0007H, 000FH, 000FH, 001FH, 0038H, 0070H       ; offset 7
              5FD : 38 70             
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 48 - 11/14/2020 15:50:57


     204/     5FF : E0 C0 C0 C0 60 60                   db 00E0H, 00C0H, 00C0H, 00C0H, 0060H, 0060H, 0020H
              605 : 20                
     205/     606 :                     
     206/     606 : 06 06 0F 7F 7F 7F   Klingon_1       db 0006H, 0006H, 000FH, 007FH, 007FH, 007FH, 001FH, 00DFH       ; offset 0
              60C : 1F DF             
     207/     60E : D9 C9 E6 F0 FF 1F                   db 00D9H, 00C9H, 00E6H, 00F0H, 00FFH, 001FH
     208/     614 :                     
     209/     614 : E0 E0 E0 80 B8 BC   Klingon_2       db 00E0H, 00E0H, 00E0H, 0080H, 00B8H, 00BCH, 003EH, 007FH       ; offset 3
              61A : 3E 7F             
     210/     61C : FF FF 81                            db 00FFH, 00FFH, 0081H
     211/     61F :                     
     212/     61F : 80 C0 E0 70 30 30   Klingon_3       db 0080H, 00C0H, 00E0H, 0070H, 0030H, 0030H, 0030H, 0030H       ; offset 12
              625 : 30 30             
     213/     627 : 60 40                               db 0060H, 0040H
     214/     629 :                     
     215/     629 :                     ;------------------------------------------------------------------------------------------
     216/     629 :                     
     217/     629 : 60 F0 F0 F0 60 70   Romulan_0       db 0060H, 00F0H, 00F0H, 00F0H, 0060H, 0070H, 0038H, 001CH       ; offset 0
              62F : 38 1C             
     218/     631 : 0F 07 03                            db 000FH, 0007H, 0003H
     219/     634 :                     
     220/     634 : 06 0F 7F FF FF F9   Romulan_1       db 0006H, 000FH, 007FH, 00FFH, 00FFH, 00F9H, 0039H, 000FH       ; offset 5
              63A : 39 0F             
     221/     63C :                     
     222/     63C : 01 E3 FF FE FC C0   Romulan_2       db 0001H, 00E3H, 00FFH, 00FEH, 00FCH, 00C0H                     ; offset 6
     223/     642 :                     
     224/     642 : 60 F0 F0 F0 60 E0   Romulan_3       db 0060H, 00F0H, 00F0H, 00F0H, 0060H, 00E0H, 00C0H, 0080H       ; offset 0
              648 : C0 80             
     225/     64A :                     
     226/     64A :                     ;------------------------------------------------------------------------------------------
     227/     64A :                     
     228/     64A :                     ; =========================================================================================
     229/     64A :                     ; Strings
     230/     64A :                     ; =========================================================================================
     231/     64A :                     
     232/     64A : 09 39 36 20 63 68   FontTitle:                      db  "\t96 char. font\n\n\0"
              650 : 61 72 2E 20 66 6F 
              656 : 6E 74 0A 0A 00    
     233/     65B : 20 21 22 23 24 25   Font1:                          db  " !\"#$%&'()*+,-.\\\0"
              661 : 26 27 28 29 2A 2B 
              667 : 2C 2D 2E 5C 00    
     234/     66C : 30 31 32 33 34 35   Font2:                          db  "0123456789:;<=>?\0"
              672 : 36 37 38 39 3A 3B 
              678 : 3C 3D 3E 3F 00    
     235/     67D : 40 41 42 43 44 45   Font3:                          db  "@ABCDEFGHIJKLMN\0"
              683 : 46 47 48 49 4A 4B 
              689 : 4C 4D 4E 00       
     236/     68D : 4F 50 51 52 53 54   Font4:                          db  "OPQRSTUVWXYZ[/]\0"
              693 : 55 56 57 58 59 5A 
              699 : 5B 2F 5D 00       
     237/     69D : 5E 5F 60 61 62 63   Font5:                          db  "^_`abcdefghijklmn\0"
              6A3 : 64 65 66 67 68 69 
              6A9 : 6A 6B 6C 6D 6E 00 
     238/     6AF : 6F 70 71 72 73 74   Font6:                          db  "opqrstuvwxyz{|}~\n\n\t\0"
              6B5 : 75 76 77 78 79 7A 
              6BB : 7B 7C 7D 7E 0A 0A 
              6C1 : 09 00             
     239/     6C3 :                     
     240/     6C3 : 42 69 67 20 53 70   SpriteTitle:                    db "Big Sprites!\0"
              6C9 : 72 69 74 65 73 21 
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 49 - 11/14/2020 15:50:57


              6CF : 00                
     241/     6D0 :                     
     242/     6D0 : 28 50 72 65 73 73   PressI                          db "(Press Input)\0"
              6D6 : 20 49 6E 70 75 74 
              6DC : 29 00             
     243/     6DE :                     
     244/     6DE :                     ;------------------------------------------------------------------------------------------
     245/     6DE :                     
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 50 - 11/14/2020 15:50:57


  Symbol Table (* = unused):
  --------------------------

*ARCHITECTURE :                                        "i386-unknown-win32" - |
 BACKBUFFER :                 "OFF" - |  BACKSPACE :                    31F C |
 BCH_BLANK :                    36E C |  BCH_DONE :                     38E C |
 BCH_GETMASK :                  368 C |  BCH_LASTBYTE :                 37E C |
 BEGINTERMINAL :                29C C | *BIGENDIAN :                      0 - |
 BIGSPRITES :                   53C C | *BITFUNCSINC :                    1 - |
 BLANKCHARACTER :               35A C |  BLANKLINE :                    2FE C |
 BL_LOOP :                      305 C | *BRANCHEXT :                      0 - |
 CANCELLINE :                   3E0 C | *CASESENSITIVE :                  0 - |
*CBB_EXIT :                     0DA C |  CHARACTERPATTERN :            7F00 C |
 CI_LOOP :                       67 C |  CLEARSCREEN :                  3E7 C |
 CM_DONE :                      337 C |  CM_TEST :                      32E C |
*CONSTPI :        3.141592653589793 - | *COPYBACKBUFFER :               0DA C |
*COPYIMAGE :                     61 C |  CREATEMASK :                   329 C |
 CURSORX :                     7F05 C |  CURSORY :                     7F06 C |
*DATE :                "11/14/2020" - |  DC_BLANK :                     356 C |
 DC_BYTELOOP :                  151 C |  DC_BYTESHIFT :                 15E C |
 DC_BYTEWRITE :                 168 C |  DC_COPYPATTERN :               14D C |
 DC_MASKLOOP :                  13A C |  DC_PREPARESECOND :             147 C |
 DC_SHIFTLOOP :                 160 C |  DC_SKIPHIGHBYTE :              11F C |
 DC_SKIPHIGHBYTE2 :             128 C |  DELAY :                         3C C |
 DISPLAYBUFFER :               7D00 C |  DISPLAYINT :                    44 C |
 DOWNCURSOR :                   34B C |  DRAWCHARACTER :                100 C |
 DRAWSPRITE :                    89 C |  DRAWSTRING :                   0DB C |
 DSP_BYTELOOP :                 0A7 C |  DSP_EXIT :                     0D9 C |
 DSP_SHIFTEXIT :                0C6 C |  DSP_SHIFTLOOP :                0BA C |
 DSP_SKIPLOWINC :                99 C |  DS_EXIT :                      0FF C |
*FALSE :                          0 - |  FILLSCREEN :                    75 C |
 FONT :                         17C C |  FONT1 :                        65B C |
 FONT2 :                        66C C |  FONT3 :                        67D C |
 FONT4 :                        68D C |  FONT5 :                        69D C |
 FONT6 :                        6AF C |  FONTTITLE :                    64A C |
 FS_LOOP :                       7B C | *FULLPMMU :                       1 - |
 GC_RELEASE :                   400 C |  GETCHAR :                      3FA C |
 GETCURSOR :                    4CB C |  HANDLECONTROLCHAR :            41B C |
*HAS64 :                          0 - | *HASDSP :                         0 - |
*HASFPU :                         0 - | *HASPMMU :                        0 - |
 HCC_BACKSPACE :                45E C |  HCC_CANCEL :                   454 C |
 HCC_DEL :                      459 C |  HCC_EXIT :                     477 C |
 HCC_FORMFEED :                 46D C |  HCC_NEWLINE :                  472 C |
 HCC_TAB :                      463 C |  HCC_UNIT :                     44D C |
 HCC_VTAB :                     468 C | *INEXTMODE :                      0 - |
*INIT :                           0 C | *INLWORDMODE :                    0 - |
*INMAXMODE :                      0 - | *INSRCMODE :                      0 - |
*INSUPMODE :                      0 - |  INT_EXIT :                      42 C |
 INT_LOOP :                      52 C |  INT_REST :                      59 C |
 KLINGON_0 :                    5F7 C |  KLINGON_1 :                    606 C |
 KLINGON_2 :                    614 C |  KLINGON_3 :                    61F C |
 LC_EXIT :                      3B3 C |  LC_HOME :                      3AD C |
 LC_PREVIOUSLINE :              39E C |  LEFTCURSOR :                   38F C |
*LISTON :                         1 - | *MACEXP :                         7 - |
 MAINLOOP :                     4DF C | *MOMCPU :                      1802 - |
*MOMCPUNAME :                "1802" - | *NESTMAX :                      100 - |
 NEXTLINE :                     33C C |  NL_EXIT :                      34A C |
*PACKING :                        0 - | *PADDING :                        1 - |
 PRESSI :                       6D0 C |  PS_EXIT :                      4B9 C |
 PS_WRITESTRING :               4A6 C | *PUTCHAR :                      414 C |
 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 51 - 11/14/2020 15:50:57


 PUTSTRING :                    4A3 C |  R0 :                             0 - |
 R1 :                             1 - |  R2 :                             2 - |
 R3 :                             3 - |  R4 :                             4 - |
 R5 :                             5 - |  R6 :                             6 - |
*R7 :                             7 - | *R8 :                             8 - |
*R9 :                             9 - | *RA :                            0A - |
 RB :                            0B - |  RC :                            0C - |
 RC_EXIT :                      3CE C |  RD :                            0D - |
 RE :                            0E - |  READHEXINPUT :                 408 C |
*RELAXED :                        0 - |  RESOLUTION :               "64x64" - |
 RF :                            0F - |  RHI_RELEASE :                  40C C |
 RIGHTCURSOR :                  3B4 C |  ROMULAN_0 :                    629 C |
 ROMULAN_1 :                    634 C |  ROMULAN_2 :                    63C C |
 ROMULAN_3 :                    642 C |  RUBOUT :                       3CF C |
 SETCURSOR :                    4BA C |  SETVIDEOFLAG :                 2F5 C |
 SPRITETITLE :                  6C3 C |  STACKTOP :                    7F7F C |
 START :                        4DC C |  STC_EXIT :                      1F C |
 STDCALL :                       20 C |  STDRETURN :                     30 C |
 STR_EXIT :                      2F C |  TABCURSOR :                    311 C |
 TAB_EXIT :                     31E C |  TEXT :                         4E7 C |
*TIME :                  "15:50:57" - | *TRUE :                           1 - |
 UNITSEPARATOR :                3D9 C |  USEGRAPHICS :               "TRUE" - |
 USETEXT :                   "TRUE" - |  USETTY :                    "TRUE" - |
*VERSION :                     142F - |  VIDEOFLAG :                   7F07 C |
 VIDEOOFF :                     2AF C |  VIDEOOFFSETX :                 2E0 C |
 VIDEOOFFSETY :                 2CF C |  VIDEOON :                      2A7 C |
 VY_SKIPLOWINC :                2DF C |  WAITFORINPUT :                 40F C |
 WAITFORSAFEUPDATE :            2B8 C |  WC_CONTROL :                   48B C |
 WC_DRAW :                      490 C | *WC_EXIT :                      4A2 C |
 WC_SETCHAR :                   481 C |  WC_UPDATECURSOR :              49F C |
 WFI_RELEASE :                  411 C |  WFSU_CHECK_DMA :               2C1 C |
 WFSU_COUNT :                   2C7 C |  WFSU_EXIT :                    2CE C |
 WFSU_NEW_EF1 :                 2C5 C |  WFSU_SYNC :                    2C3 C |
 WRITECHAR :                    478 C | *WRITEHEXOUTPUT :               403 C |
*Z80SYNTAX :                      0 - |

    182 symbols
     41 unused symbols

 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 52 - 11/14/2020 15:50:57


  Defined Macros:
  ---------------

CALL                                  | LOAD                                 
RETURN                                |

      3 macros

 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 53 - 11/14/2020 15:50:57


  Defined Functions:
  ------------------

ROTRN                                 | ROTLN                                
SHRN                                  | SHLN                                 
GETBIT                                | EVEN                                 
ODD                                   | LOWORD                               
HIWORD                                | LO                                   
HI                                    | CUTOUT                               
INVMASK                               | MASK                                 

 AS V1.42 Beta [Bld 172] - Source File FullDemo.asm - Page 54 - 11/14/2020 15:50:57


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.22 seconds assembly time

   2632 lines source file
   2933 lines incl. macro expansions
      2 passes
      0 errors
      0 warnings
